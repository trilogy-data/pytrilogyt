const _trilogyt._created_at <- current_datetime();

import store_sales as store_sales;

WHERE
    store_sales.date.month_of_year = 11 and store_sales.item.manufacturer_id = 128
SELECT
    store_sales.date.year,
    store_sales.item.brand_id,
    store_sales.item.brand_name,
    sum(store_sales.ext_sales_price) -> sum_agg,
ORDER BY
    store_sales.date.year asc,
    sum_agg desc,
    store_sales.item.brand_id asc
LIMIT 100
;

PERSIST default.dse8c5b59e0737539bf620f5ad5df1cdeac6aee638d9fdb565dc4e3c2bb86c5e51_filtered_on_month_of_year_manufacturer_id INTO dse8c5b59e0737539bf620f5ad5df1cdeac6aee638d9fdb565dc4e3c2bb86c5e51_filtered_on_month_of_year_manufacturer_id FROM WHERE
    store_sales.date.month_of_year = 11 and store_sales.item.manufacturer_id = 128
SELECT
    store_sales.date.year,
    store_sales.ext_sales_price,
    store_sales.item.brand_id,
    store_sales.item.brand_name,
    store_sales.item.id,
    store_sales.ticket_number,
;

PERSIST default.dsa595e281b60524e545482e53228e33c3788bb028fa078950654a70bb2a765dea INTO dsa595e281b60524e545482e53228e33c3788bb028fa078950654a70bb2a765dea FROM SELECT
    sum_agg,
    store_sales.date.year,
    store_sales.item.brand_id,
    store_sales.item.brand_name,
;