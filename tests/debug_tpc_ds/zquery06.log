base_prep_time = 2e-06
base_parse_time = 0.46547
base_generation_time = 0.019551
base_exec_time = 0.035773
base_generated_sql = """

WITH 
charming as (
SELECT
    \"item_items\".\"I_CATEGORY\" as \"item_category\",
    \"store_sales_customer_customer_address\".\"CA_STATE\" as \"store_sales_customer_state\",
    \"store_sales_date_date\".\"D_MOY\" as \"store_sales_date_month_of_year\",
    \"store_sales_item_items\".\"I_CATEGORY\" as \"store_sales_item_category\",
    \"store_sales_item_items\".\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",
    \"store_sales_item_items\".\"I_ITEM_SK\" as \"item_id\",
    \"store_sales_store_sales\".\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\",
    cast(\"store_sales_date_date\".\"D_YEAR\" as int) as \"store_sales_date_year\"
FROM
    \"memory\".\"store_sales\" as \"store_sales_store_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"store_sales_date_date\" on \"store_sales_store_sales\".\"SS_SOLD_DATE_SK\" = \"store_sales_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"customer\" as \"store_sales_customer_customers\" on \"store_sales_store_sales\".\"SS_CUSTOMER_SK\" = \"store_sales_customer_customers\".\"C_CUSTOMER_SK\"
    INNER JOIN \"memory\".\"customer_address\" as \"store_sales_customer_customer_address\" on \"store_sales_customer_customers\".\"C_CURRENT_ADDR_SK\" = \"store_sales_customer_customer_address\".\"CA_ADDRESS_SK\"
    INNER JOIN \"memory\".\"item\" as \"store_sales_item_items\" on \"store_sales_store_sales\".\"SS_ITEM_SK\" = \"store_sales_item_items\".\"I_ITEM_SK\"
    INNER JOIN \"memory\".\"item\" as \"item_items\" on \"store_sales_store_sales\".\"SS_ITEM_SK\" = \"item_items\".\"I_ITEM_SK\"
WHERE
    cast(\"store_sales_date_date\".\"D_YEAR\" as int) = 2001 and \"store_sales_date_date\".\"D_MOY\" = 1 and \"store_sales_item_items\".\"I_CATEGORY\" is not null
),
protective as (
SELECT
    \"item_items\".\"I_CATEGORY\" as \"item_category\",
    avg(\"item_items\".\"I_CURRENT_PRICE\") as \"_virt_agg_avg_5942253052406187\"
FROM
    \"memory\".\"item\" as \"item_items\"
GROUP BY 
    \"item_items\".\"I_CATEGORY\"),
premium as (
SELECT
    \"charming\".\"item_id\" as \"item_id\",
    \"charming\".\"store_sales_customer_state\" as \"store_sales_customer_state\",
    \"charming\".\"store_sales_ticket_number\" as \"store_sales_ticket_number\"
FROM
    \"charming\"
    INNER JOIN \"protective\" on (\"charming\".\"item_category\" = \"protective\".\"item_category\" or (\"charming\".\"item_category\" is null and \"protective\".\"item_category\" is null))
WHERE
    \"charming\".\"store_sales_date_year\" = 2001 and \"charming\".\"store_sales_date_month_of_year\" = 1 and \"charming\".\"store_sales_item_current_price\" > 1.2 * \"protective\".\"_virt_agg_avg_5942253052406187\" and \"charming\".\"store_sales_item_category\" is not null
),
puzzled as (
SELECT
    \"premium\".\"item_id\" as \"item_id\",
    \"premium\".\"store_sales_customer_state\" as \"store_sales_customer_state\",
    \"premium\".\"store_sales_ticket_number\" as \"store_sales_ticket_number\"
FROM
    \"premium\"
GROUP BY 
    \"premium\".\"item_id\",
    \"premium\".\"store_sales_customer_state\",
    \"premium\".\"store_sales_ticket_number\")
SELECT
    \"puzzled\".\"store_sales_customer_state\" as \"store_sales_customer_state\",
    sum(1) as \"customer_count\"
FROM
    \"puzzled\"
GROUP BY 
    \"puzzled\".\"store_sales_customer_state\"
HAVING
    sum(1) >= 10

ORDER BY 
    sum(1) asc nulls first,
    \"puzzled\".\"store_sales_customer_state\" asc nulls first"""
optimized_prep_time = 4e-06
optimized_parse_time = 0.55879
optimized_generation_time = 0.017376
optimized_exec_time = 0.041125
optimized_generated_sql = """

WITH 
colossal as (
SELECT
    \"item_items\".\"I_CATEGORY\" as \"item_category\",
    \"store_sales_customer_customer_address\".\"CA_STATE\" as \"store_sales_customer_state\",
    \"store_sales_date_date\".\"D_MOY\" as \"store_sales_date_month_of_year\",
    \"store_sales_item_items\".\"I_CATEGORY\" as \"store_sales_item_category\",
    \"store_sales_item_items\".\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",
    \"store_sales_item_items\".\"I_ITEM_SK\" as \"item_id\",
    \"store_sales_store_sales\".\"SS_TICKET_NUMBER\" as \"store_sales_ticket_number\",
    cast(\"store_sales_date_date\".\"D_YEAR\" as int) as \"store_sales_date_year\"
FROM
    \"memory\".\"store_sales\" as \"store_sales_store_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"store_sales_date_date\" on \"store_sales_store_sales\".\"SS_SOLD_DATE_SK\" = \"store_sales_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"customer\" as \"store_sales_customer_customers\" on \"store_sales_store_sales\".\"SS_CUSTOMER_SK\" = \"store_sales_customer_customers\".\"C_CUSTOMER_SK\"
    INNER JOIN \"memory\".\"customer_address\" as \"store_sales_customer_customer_address\" on \"store_sales_customer_customers\".\"C_CURRENT_ADDR_SK\" = \"store_sales_customer_customer_address\".\"CA_ADDRESS_SK\"
    INNER JOIN \"memory\".\"item\" as \"store_sales_item_items\" on \"store_sales_store_sales\".\"SS_ITEM_SK\" = \"store_sales_item_items\".\"I_ITEM_SK\"
    INNER JOIN \"memory\".\"item\" as \"item_items\" on \"store_sales_store_sales\".\"SS_ITEM_SK\" = \"item_items\".\"I_ITEM_SK\"
WHERE
    cast(\"store_sales_date_date\".\"D_YEAR\" as int) = 2001
),
sloppy as (
SELECT
    \"item_items\".\"I_CATEGORY\" as \"item_category\",
    avg(\"item_items\".\"I_CURRENT_PRICE\") as \"_virt_agg_avg_5942253052406187\"
FROM
    \"memory\".\"item\" as \"item_items\"
GROUP BY 
    \"item_items\".\"I_CATEGORY\"),
obsolete as (
SELECT
    \"colossal\".\"item_id\" as \"item_id\",
    \"colossal\".\"store_sales_customer_state\" as \"store_sales_customer_state\",
    \"colossal\".\"store_sales_ticket_number\" as \"store_sales_ticket_number\"
FROM
    \"colossal\"
    INNER JOIN \"sloppy\" on (\"colossal\".\"item_category\" = \"sloppy\".\"item_category\" or (\"colossal\".\"item_category\" is null and \"sloppy\".\"item_category\" is null))
WHERE
    \"colossal\".\"store_sales_date_year\" = 2001 and ( \"colossal\".\"store_sales_date_month_of_year\" = 1 and ( \"colossal\".\"store_sales_item_current_price\" > 1.2 * \"sloppy\".\"_virt_agg_avg_5942253052406187\" and \"colossal\".\"store_sales_item_category\" is not null ) )
),
elegant as (
SELECT
    \"obsolete\".\"item_id\" as \"item_id\",
    \"obsolete\".\"store_sales_customer_state\" as \"store_sales_customer_state\",
    \"obsolete\".\"store_sales_ticket_number\" as \"store_sales_ticket_number\"
FROM
    \"obsolete\"
GROUP BY 
    \"obsolete\".\"item_id\",
    \"obsolete\".\"store_sales_customer_state\",
    \"obsolete\".\"store_sales_ticket_number\")
SELECT
    \"elegant\".\"store_sales_customer_state\" as \"store_sales_customer_state\",
    sum(1) as \"customer_count\"
FROM
    \"elegant\"
GROUP BY 
    \"elegant\".\"store_sales_customer_state\"
HAVING
    sum(1) >= 10

ORDER BY 
    sum(1) asc nulls first,
    \"elegant\".\"store_sales_customer_state\" asc nulls first"""
query_id = 6
sql_comp_time = 0.053761
total_time = 1.209086
