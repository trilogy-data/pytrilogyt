base_prep_time = 3e-06
base_parse_time = 0.423234
base_generation_time = 0.005483
base_exec_time = 0.071104
base_generated_sql = """

WITH 
thoughtful as (
SELECT
    \"returns_store_returns\".\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    \"returns_store_returns\".\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
GROUP BY 
    \"returns_store_returns\".\"SR_CUSTOMER_SK\",
    \"returns_store_returns\".\"SR_RETURNED_DATE_SK\",
    \"returns_store_returns\".\"SR_STORE_SK\"),
abundant as (
SELECT
    \"returns_store_returns\".\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_returns\".\"SR_ITEM_SK\" as \"returns_item_id\",
    \"returns_store_returns\".\"SR_RETURN_AMT\" as \"returns_return_amount\",
    \"returns_store_returns\".\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"returns_store_returns\".\"SR_STORE_SK\" = \"returns_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" = \"returns_return_date_date\".\"D_DATE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000
),
cooperative as (
SELECT
    \"returns_customer_customers\".\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    \"returns_customer_customers\".\"C_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\"
FROM
    \"thoughtful\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"thoughtful\".\"returns_store_id\" = \"returns_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"customer\" as \"returns_customer_customers\" on \"thoughtful\".\"returns_customer_id\" = \"returns_customer_customers\".\"C_CUSTOMER_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"thoughtful\".\"returns_return_date_id\" = \"returns_return_date_date\".\"D_DATE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000
),
uneven as (
SELECT
    \"abundant\".\"returns_customer_id\" as \"returns_customer_id\",
    \"abundant\".\"returns_store_id\" as \"returns_store_id\",
    sum(\"abundant\".\"returns_return_amount\") as \"total_returns\"
FROM
    \"abundant\"
GROUP BY 
    \"abundant\".\"returns_customer_id\",
    \"abundant\".\"returns_store_id\"),
questionable as (
SELECT
    \"cooperative\".\"returns_customer_id\" as \"returns_customer_id\",
    \"cooperative\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"cooperative\".\"returns_store_id\" as \"returns_store_id\"
FROM
    \"cooperative\"
GROUP BY 
    \"cooperative\".\"returns_customer_id\",
    \"cooperative\".\"returns_customer_text_id\",
    \"cooperative\".\"returns_store_id\"),
juicy as (
SELECT
    \"uneven\".\"returns_store_id\" as \"returns_store_id\",
    avg(\"uneven\".\"total_returns\") as \"avg_store_returns\"
FROM
    \"uneven\"
GROUP BY 
    \"uneven\".\"returns_store_id\"),
yummy as (
SELECT
    \"questionable\".\"returns_customer_id\" as \"returns_customer_id\",
    \"questionable\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"questionable\".\"returns_store_id\" as \"returns_store_id\",
    \"uneven\".\"total_returns\" as \"total_returns\"
FROM
    \"questionable\"
    INNER JOIN \"uneven\" on \"questionable\".\"returns_customer_id\" = \"uneven\".\"returns_customer_id\" AND \"questionable\".\"returns_store_id\" = \"uneven\".\"returns_store_id\"),
vacuous as (
SELECT
    \"juicy\".\"avg_store_returns\" as \"avg_store_returns\",
    \"yummy\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"yummy\".\"returns_store_id\" as \"returns_store_id\",
    \"yummy\".\"total_returns\" as \"total_returns\"
FROM
    \"yummy\"
    INNER JOIN \"juicy\" on \"yummy\".\"returns_store_id\" = \"juicy\".\"returns_store_id\")
SELECT
    \"vacuous\".\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    \"vacuous\"
WHERE
    \"vacuous\".\"total_returns\" > ( 1.2 * \"vacuous\".\"avg_store_returns\" )

GROUP BY 
    \"vacuous\".\"avg_store_returns\",
    \"vacuous\".\"returns_customer_text_id\",
    \"vacuous\".\"returns_store_id\",
    \"vacuous\".\"total_returns\"
ORDER BY 
    \"vacuous\".\"returns_customer_text_id\" asc
LIMIT (100)"""
optimized_prep_time = 3e-06
optimized_parse_time = 0.660482
optimized_generation_time = 0.005796
optimized_exec_time = 0.057154
optimized_generated_sql = """

WITH 
exuberant as (
SELECT
    \"returns_store_returns\".\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",
    \"returns_store_returns\".\"SR_STORE_SK\" as \"returns_store_id\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
GROUP BY 
    \"returns_store_returns\".\"SR_CUSTOMER_SK\",
    \"returns_store_returns\".\"SR_RETURNED_DATE_SK\",
    \"returns_store_returns\".\"SR_STORE_SK\"),
odd as (
SELECT
    \"returns_store_returns\".\"SR_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_returns\".\"SR_ITEM_SK\" as \"returns_item_id\",
    \"returns_store_returns\".\"SR_RETURN_AMT\" as \"returns_return_amount\",
    \"returns_store_returns\".\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"returns_store_returns\".\"SR_STORE_SK\" = \"returns_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" = \"returns_return_date_date\".\"D_DATE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000
),
faithful as (
SELECT
    \"returns_customer_customers\".\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    \"returns_customer_customers\".\"C_CUSTOMER_SK\" as \"returns_customer_id\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\"
FROM
    \"exuberant\"
    INNER JOIN \"memory\".\"customer\" as \"returns_customer_customers\" on \"exuberant\".\"returns_customer_id\" = \"returns_customer_customers\".\"C_CUSTOMER_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"exuberant\".\"returns_return_date_id\" = \"returns_return_date_date\".\"D_DATE_SK\"
    INNER JOIN \"ds076b41e98d63ade6d76668df39d060a23d05937779557c564c9c9741a7ecc775\" as \"default_ds076b41e98d63ade6d76668df39d060a23d05937779557c564c9c9741a7ecc775\" on \"returns_customer_customers\".\"C_CUSTOMER_ID\" = \"default_ds076b41e98d63ade6d76668df39d060a23d05937779557c564c9c9741a7ecc775\".\"returns_customer_text_id\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"exuberant\".\"returns_store_id\" = \"returns_store_store\".\"S_STORE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000
),
sordid as (
SELECT
    \"odd\".\"returns_customer_id\" as \"returns_customer_id\",
    \"odd\".\"returns_store_id\" as \"returns_store_id\",
    sum(\"odd\".\"returns_return_amount\") as \"total_returns\"
FROM
    \"odd\"
GROUP BY 
    \"odd\".\"returns_customer_id\",
    \"odd\".\"returns_store_id\"),
helpless as (
SELECT
    \"faithful\".\"returns_customer_id\" as \"returns_customer_id\",
    \"faithful\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"faithful\".\"returns_store_id\" as \"returns_store_id\"
FROM
    \"faithful\"
GROUP BY 
    \"faithful\".\"returns_customer_id\",
    \"faithful\".\"returns_customer_text_id\",
    \"faithful\".\"returns_store_id\"),
imported as (
SELECT
    \"sordid\".\"returns_store_id\" as \"returns_store_id\",
    avg(\"sordid\".\"total_returns\") as \"avg_store_returns\"
FROM
    \"sordid\"
GROUP BY 
    \"sordid\".\"returns_store_id\"),
blue as (
SELECT
    \"helpless\".\"returns_customer_id\" as \"returns_customer_id\",
    \"helpless\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"helpless\".\"returns_store_id\" as \"returns_store_id\",
    \"sordid\".\"total_returns\" as \"total_returns\"
FROM
    \"helpless\"
    INNER JOIN \"sordid\" on \"helpless\".\"returns_customer_id\" = \"sordid\".\"returns_customer_id\" AND \"helpless\".\"returns_store_id\" = \"sordid\".\"returns_store_id\"),
ugly as (
SELECT
    \"blue\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"blue\".\"returns_store_id\" as \"returns_store_id\",
    \"blue\".\"total_returns\" as \"total_returns\",
    \"imported\".\"avg_store_returns\" as \"avg_store_returns\"
FROM
    \"blue\"
    INNER JOIN \"imported\" on \"blue\".\"returns_store_id\" = \"imported\".\"returns_store_id\")
SELECT
    \"ugly\".\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    \"ugly\"
WHERE
    \"ugly\".\"total_returns\" > ( 1.2 * \"ugly\".\"avg_store_returns\" )

GROUP BY 
    \"ugly\".\"avg_store_returns\",
    \"ugly\".\"returns_customer_text_id\",
    \"ugly\".\"returns_store_id\",
    \"ugly\".\"total_returns\"
ORDER BY 
    \"ugly\".\"returns_customer_text_id\" asc
LIMIT (100)"""
query_id = 1
sql_comp_time = 0.539925
total_time = 1.775292
