import _trilogyt_opt_384fcf06882ec748548f58f15ac81014cfb473778367428f9b8ef02ad1579648;

WHERE
    cs.item.category in ('Sports', 'Books', 'Home') and (cs.sold_date.date >= '1999-02-22'::date and cs.sold_date.date <= '1999-03-24'::date)
SELECT
    cs.item.name,
    cs.item.desc,
    cs.item.category,
    cs.item.class,
    cs.item.current_price,
    sum(cs.extra_sales_price) -> revenue,
    revenue * 100.0 / (sum revenue over cs.item.class) -> revenue_ratio,
HAVING
    cs.item.name is not null

ORDER BY
    cs.item.category asc nulls first,
    cs.item.class asc nulls first,
    cs.item.name asc nulls first,
    cs.item.desc asc nulls first,
    revenue_ratio asc nulls first
LIMIT 100
;