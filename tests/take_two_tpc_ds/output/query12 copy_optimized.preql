import _trilogyt_opt_caeb4e8dc3ef94b019cce94c3ca117ca19c746aba79293664400533a57a8cedc;

WHERE
    (web_sales.date.date >= '1999-02-22'::date and web_sales.date.date <= '1999-03-24'::date) and web_sales.item.category in ('Sports', 'Books', 'Home')
SELECT
    web_sales.item.name,
    web_sales.item.desc,
    web_sales.item.category,
    web_sales.item.class,
    web_sales.item.current_price,
    sum(web_sales.extra_sales_price) -> itemrevenue,
    --sum itemrevenue over web_sales.item.class -> itemclassrevenue,
    (itemrevenue * 100.0) / itemclassrevenue -> revenueratio,
ORDER BY
    web_sales.item.category asc,
    web_sales.item.class asc,
    web_sales.item.name asc,
    web_sales.item.desc asc,
    revenueratio asc
LIMIT 100
;