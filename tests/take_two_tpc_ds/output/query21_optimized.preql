import _trilogyt_opt_5a993bdd2ef56e5aa77ca35093a680f736282f105439e42f9dfec084f9b22179;

WHERE
    (inventory.date.date >= '2000-02-10'::date and inventory.date.date <= '2000-04-10'::date) and (inventory.item.current_price >= 0.99 and inventory.item.current_price <= 1.49)
SELECT
    inventory.warehouse.name,
    inventory.item.name,
    sum(CASE WHEN inventory.date.date < '2000-03-11'::date THEN inventory.quantity_on_hand
ELSE 0
END) -> inv_before,
    sum(CASE WHEN inventory.date.date >= '2000-03-11'::date THEN inventory.quantity_on_hand
ELSE 0
END) -> inv_after,
HAVING
    CASE WHEN inv_before > 0 THEN (inv_after * 1.0) / inv_before
ELSE null
END >= 2.0 / 3.0 and CASE WHEN inv_before > 0 THEN (inv_after * 1.0) / inv_before
ELSE null
END <= 3.0 / 2.0

ORDER BY
    inventory.warehouse.name asc nulls first,
    inventory.item.name asc nulls first
LIMIT 100
;