{
    "query_id": 3,
    "parse_time": 8.765034,
    "generation_time": 0.006004,
    "exec_time": 2.078249,
    "comp_time": 0.399604,
    "total_time": 11.252893,
    "generated_sql": "\nWITH \nodd as (\nSELECT\n    date.D_DATE_SK as \"store_sales_date_id\",\n    date.D_MOY as \"store_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\nresonant as (\nSELECT\n    store_sales.SS_EXT_SALES_PRICE as \"store_sales_ext_sales_price\",\n    odd.store_sales_date_month_of_year as \"store_sales_date_month_of_year\",\n    items.I_MANUFACT_ID as \"store_sales_item_manufacturer_id\",\n    items.I_BRAND_ID as \"store_sales_item_brand_id\",\n    items.I_BRAND as \"store_sales_item_brand_name\",\n    odd.store_sales_date_year as \"store_sales_date_year\",\n    store_sales.SS_TICKET_NUMBER as \"store_sales_ticket_number\",\n    coalesce(store_sales.SS_ITEM_SK,items.I_ITEM_SK) as \"store_sales_item_id\"\nFROM\n    memory.store_sales as store_sales\n    LEFT OUTER JOIN odd on store_sales.\"SS_SOLD_DATE_SK\" = odd.\"store_sales_date_id\"\n    LEFT OUTER JOIN memory.item as items on store_sales.\"SS_ITEM_SK\" = items.\"I_ITEM_SK\"\n),\nexuberant as (\nSELECT\n    CASE WHEN ( resonant.store_sales_date_month_of_year = 11 and resonant.store_sales_item_manufacturer_id = 128 )  THEN resonant.store_sales_ext_sales_price ELSE NULL END as \"_virtual_157286030986746\",\n    resonant.store_sales_ext_sales_price as \"store_sales_ext_sales_price\",\n    resonant.store_sales_date_month_of_year as \"store_sales_date_month_of_year\",\n    resonant.store_sales_item_manufacturer_id as \"store_sales_item_manufacturer_id\",\n    resonant.store_sales_item_brand_id as \"store_sales_item_brand_id\",\n    resonant.store_sales_item_brand_name as \"store_sales_item_brand_name\",\n    resonant.store_sales_date_year as \"store_sales_date_year\",\n    resonant.store_sales_ticket_number as \"store_sales_ticket_number\",\n    resonant.store_sales_item_id as \"store_sales_item_id\"\nFROM\n    resonant as resonant\n),\nstarling as (\nSELECT\n    sum(exuberant._virtual_157286030986746) as \"sum_agg\",\n    exuberant.store_sales_item_brand_id as \"store_sales_item_brand_id\",\n    exuberant.store_sales_item_brand_name as \"store_sales_item_brand_name\",\n    exuberant.store_sales_date_year as \"store_sales_date_year\"\nFROM\n    exuberant as exuberant\n\nGROUP BY \n    exuberant.store_sales_date_year,\n    exuberant.store_sales_item_brand_name,\n    exuberant.store_sales_item_brand_id)\nSELECT\n    starling.\"store_sales_date_year\",\n    starling.\"store_sales_item_brand_id\",\n    starling.\"store_sales_item_brand_name\",\n    starling.\"sum_agg\"\nFROM\n    starling\nWHERE\n    starling.\"sum_agg\" > 0\n\nORDER BY \n    starling.\"store_sales_date_year\" asc,\n\n    starling.\"sum_agg\" desc,\n\n    starling.\"store_sales_item_brand_id\" asc\n\nLIMIT (100)"
}