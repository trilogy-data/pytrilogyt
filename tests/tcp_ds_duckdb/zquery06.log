{
    "query_id": 6,
    "parse_time": 1.555689,
    "generation_time": 0.0,
    "exec_time": 3.561932,
    "comp_time": 3.041616,
    "total_time": 13.410119,
    "sql_comp_time": 2.267851,
    "generated_sql": "\nWITH \nuneven as (\nSELECT\n    store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",\n    store_sales.\"SS_ITEM_SK\" as \"item_id\",\n    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\"\nFROM\n    memory.store_sales as store_sales\nGROUP BY \n    store_sales.\"SS_ITEM_SK\",\n    store_sales.\"SS_SOLD_DATE_SK\",\n    store_sales.\"SS_CUSTOMER_SK\"),\nyummy as (\nSELECT\n    items.\"I_ITEM_SK\" as \"item_id\",\n    items.\"I_CATEGORY\" as \"item_category\",\n    items.\"I_CURRENT_PRICE\" as \"item_current_price\"\nFROM\n    memory.item as items),\nvacuous as (\nSELECT\n    avg(items.\"I_CURRENT_PRICE\") as \"_virtual_6264207893106521\",\n    items.\"I_CATEGORY\" as \"item_category\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_CATEGORY\"),\njuicy as (\nSELECT\n    yummy.\"item_category\" as \"item_category\",\n    customers.\"C_CUSTOMER_SK\" as \"store_sales_customer_id\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\",\n    date.\"D_MOY\" as \"store_sales_date_month_of_year\",\n    items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",\n    customer_address.\"CA_STATE\" as \"store_sales_customer_state\"\nFROM\n    memory.item as items\n    INNER JOIN uneven on items.\"I_ITEM_SK\" = uneven.\"item_id\"\n    INNER JOIN yummy on items.\"I_ITEM_SK\" = yummy.\"item_id\"\n    FULL JOIN memory.customer as customers on uneven.\"store_sales_customer_id\" = customers.\"C_CUSTOMER_SK\"\n    LEFT OUTER JOIN memory.date_dim as date on uneven.\"store_sales_date_id\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.customer_address as customer_address on customers.\"C_CURRENT_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2001 and date.\"D_MOY\" = 1\n),\nconcerned as (\nSELECT\n    juicy.\"item_category\" as \"item_category\",\n    juicy.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    juicy.\"store_sales_date_year\" as \"store_sales_date_year\",\n    juicy.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    juicy.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    juicy.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    vacuous.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\"\nFROM\n    juicy\n    INNER JOIN vacuous on juicy.\"item_category\" = vacuous.\"item_category\"\nWHERE\n    juicy.\"store_sales_date_year\" = 2001 and juicy.\"store_sales_date_month_of_year\" = 1 and juicy.\"store_sales_item_current_price\" > 1.2 * vacuous.\"_virtual_6264207893106521\"\n)\nSELECT\n    concerned.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    count(concerned.\"store_sales_customer_id\") as \"customer_count\"\nFROM\n    concerned\nGROUP BY \n    concerned.\"store_sales_customer_state\"\nHAVING\n    count(concerned.\"store_sales_customer_id\") > 10\n\nORDER BY \n    count(concerned.\"store_sales_customer_id\") asc,\n    concerned.\"store_sales_customer_state\" asc"
}