{
    "query_id": 6,
    "parse_time": 10.216861,
    "generation_time": 0.003506,
    "exec_time": 6.202318,
    "comp_time": 1.588186,
    "total_time": 18.011864,
    "generated_sql": "\nWITH \nstork as (\nSELECT\n    items.I_CURRENT_PRICE as \"item_current_price\",\n    items.I_CATEGORY as \"item_category\",\n    items.I_ITEM_SK as \"item_id\",\n    items.I_ITEM_SK as \"__merge_store_sales_item_id_item_id\"\nFROM\n    memory.item as items\n),\nlate as (\nSELECT\n    avg(stork.item_current_price) as \"_virtual_6264207893106521\",\n    stork.item_category as \"item_category\"\nFROM\n    stork as stork\n\nGROUP BY \n    stork.item_category),\nodd as (\nSELECT\n    date.D_DATE_SK as \"store_sales_date_id\",\n    date.D_MOY as \"store_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\ncooperative as (\nSELECT\n    items.I_ITEM_SK as \"store_sales_item_id\",\n    items.I_CURRENT_PRICE as \"store_sales_item_current_price\",\n    items.I_ITEM_SK as \"__merge_store_sales_item_id_item_id\"\nFROM\n    memory.item as items\n),\nmartin as (\nSELECT\n    cooperative.store_sales_item_id as \"store_sales_item_id\",\n    coalesce(cooperative.__merge_store_sales_item_id_item_id,stork.__merge_store_sales_item_id_item_id) as \"__merge_store_sales_item_id_item_id\",\n    stork.item_id as \"item_id\"\nFROM\n    cooperative as cooperative\n    FULL JOIN stork on cooperative.\"__merge_store_sales_item_id_item_id\" = stork.\"__merge_store_sales_item_id_item_id\"\n),\nbusy as (\nSELECT\n    coalesce(martin.store_sales_item_id,store_sales.SS_ITEM_SK) as \"store_sales_item_id\",\n    martin.__merge_store_sales_item_id_item_id as \"__merge_store_sales_item_id_item_id\",\n    martin.item_id as \"item_id\",\n    store_sales.SS_CUSTOMER_SK as \"store_sales_customer_id\",\n    store_sales.SS_SOLD_DATE_SK as \"store_sales_date_id\"\nFROM\n    memory.store_sales as store_sales\n    LEFT OUTER JOIN martin on store_sales.\"SS_ITEM_SK\" = martin.\"store_sales_item_id\"\n),\ncoot as (\nSELECT\n    stork.item_category as \"item_category\",\n    cooperative.store_sales_item_current_price as \"store_sales_item_current_price\",\n    coalesce(busy.store_sales_customer_id,customers.C_CUSTOMER_SK) as \"store_sales_customer_id\",\n    odd.store_sales_date_month_of_year as \"store_sales_date_month_of_year\",\n    customer_address.CA_STATE as \"store_sales_customer_state\",\n    odd.store_sales_date_year as \"store_sales_date_year\"\nFROM\n    busy as busy\n    LEFT OUTER JOIN cooperative on busy.\"store_sales_item_id\" = cooperative.\"store_sales_item_id\"\n    LEFT OUTER JOIN stork on busy.\"item_id\" = stork.\"item_id\"\n    LEFT OUTER JOIN memory.customer as customers on busy.\"store_sales_customer_id\" = customers.\"C_CUSTOMER_SK\"\n    LEFT OUTER JOIN odd on busy.\"store_sales_date_id\" = odd.\"store_sales_date_id\"\n    LEFT OUTER JOIN memory.customer_address as customer_address on customers.\"C_CURRENT_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"\n),\ncool as (\nSELECT\n    coalesce(coot.item_category,late.item_category) as \"item_category\",\n    coot.store_sales_item_current_price as \"store_sales_item_current_price\",\n    coot.store_sales_customer_id as \"store_sales_customer_id\",\n    coot.store_sales_date_month_of_year as \"store_sales_date_month_of_year\",\n    coot.store_sales_customer_state as \"store_sales_customer_state\",\n    coot.store_sales_date_year as \"store_sales_date_year\",\n    late._virtual_6264207893106521 as \"_virtual_6264207893106521\"\nFROM\n    coot as coot\n    LEFT OUTER JOIN late on coot.\"item_category\" = late.\"item_category\"\n),\nwooden as (\nSELECT\n    CASE WHEN ( cool.store_sales_date_year = 2001 and ( cool.store_sales_date_month_of_year = 1 and cool.store_sales_item_current_price > (1.2 * cool._virtual_6264207893106521) )  )  THEN cool.store_sales_customer_id ELSE NULL END as \"_virtual_2199770937262919\",\n    cool.store_sales_customer_id as \"store_sales_customer_id\",\n    cool.store_sales_date_year as \"store_sales_date_year\",\n    cool.store_sales_date_month_of_year as \"store_sales_date_month_of_year\",\n    cool.store_sales_item_current_price as \"store_sales_item_current_price\",\n    cool._virtual_6264207893106521 as \"_virtual_6264207893106521\",\n    cool.store_sales_customer_state as \"store_sales_customer_state\"\nFROM\n    cool as cool\n),\ntoucan as (\nSELECT\n    count(wooden._virtual_2199770937262919) as \"customer_count\",\n    wooden.store_sales_customer_state as \"store_sales_customer_state\"\nFROM\n    wooden as wooden\n\nGROUP BY \n    wooden.store_sales_customer_state)\nSELECT\n    toucan.\"store_sales_customer_state\",\n    toucan.\"customer_count\"\nFROM\n    toucan\nWHERE\n    toucan.\"customer_count\" >= 10\n\nORDER BY \n    toucan.\"customer_count\" asc,\n\n    toucan.\"store_sales_customer_state\" asc\n"
}