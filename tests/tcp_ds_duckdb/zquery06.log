{
    "query_id": 6,
    "parse_time": 2.897525,
    "generation_time": 0.0,
    "exec_time": 6.018973,
    "comp_time": 3.132902,
    "total_time": 20.710286,
    "sql_comp_time": 3.196737,
    "generated_sql": "\nWITH \nviper as (\nSELECT\n    avg(items.\"I_CURRENT_PRICE\") as \"_virtual_6264207893106521\",\n    items.\"I_CATEGORY\" as \"item_category\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_CATEGORY\"),\nquizzical as (\nSELECT\n    items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",\n    items.\"I_ITEM_SK\" as \"item_id\"\nFROM\n    memory.item as items),\npetrel as (\nSELECT\n    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\",\n    store_sales.\"SS_ITEM_SK\" as \"item_id\",\n    store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\"\nFROM\n    memory.store_sales as store_sales\nGROUP BY \n    store_sales.\"SS_CUSTOMER_SK\",\n    store_sales.\"SS_ITEM_SK\",\n    store_sales.\"SS_SOLD_DATE_SK\"),\ntearful as (\nSELECT\n    date.\"D_DATE_SK\" as \"store_sales_date_id\",\n    petrel.\"item_id\" as \"item_id\",\n    petrel.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    date.\"D_MOY\" as \"store_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    petrel\n    LEFT OUTER JOIN memory.date_dim as date on petrel.\"store_sales_date_id\" = date.\"D_DATE_SK\"\nWHERE\n    cast(\"D_YEAR\" as int) = 2001 and date.\"D_MOY\" = 1\n),\nquetzal as (\nSELECT\n    customers.\"C_CURRENT_ADDR_SK\" as \"store_sales_customer_address_id\",\n    customers.\"C_CUSTOMER_SK\" as \"store_sales_customer_id\",\n    customer_address.\"CA_STATE\" as \"store_sales_customer_state\"\nFROM\n    memory.customer as customers\n    LEFT OUTER JOIN memory.customer_address as customer_address on customers.\"C_CURRENT_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"),\nfriendly as (\nSELECT\n    items.\"I_CATEGORY\" as \"item_category\",\n    quizzical.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    quetzal.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    tearful.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    quetzal.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    tearful.\"store_sales_date_year\" as \"store_sales_date_year\"\nFROM\n    quetzal\n    LEFT OUTER JOIN tearful on quetzal.\"store_sales_customer_id\" = tearful.\"store_sales_customer_id\"\n    LEFT OUTER JOIN memory.item as items on tearful.\"item_id\" = items.\"I_ITEM_SK\"\n    LEFT OUTER JOIN quizzical on tearful.\"item_id\" = quizzical.\"item_id\"\nWHERE\n    tearful.\"store_sales_date_year\" = 2001 and tearful.\"store_sales_date_month_of_year\" = 1\n),\nobsolete as (\nSELECT\n    friendly.\"store_sales_customer_id\" as \"store_sales_customer_id_filter_8865878216402248\",\n    friendly.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    friendly\n    LEFT OUTER JOIN viper on friendly.\"item_category\" = viper.\"item_category\"\nWHERE\n    friendly.\"store_sales_date_year\" = 2001 and friendly.\"store_sales_date_month_of_year\" = 1 and friendly.\"store_sales_item_current_price\" > 1.2 * viper.\"_virtual_6264207893106521\"\n),\nfossa as (\nSELECT\n    count(obsolete.\"store_sales_customer_id_filter_8865878216402248\") as \"customer_count\",\n    obsolete.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    obsolete\nGROUP BY \n    obsolete.\"store_sales_customer_state\"),\nmagpie as (\nSELECT\n    friendly.\"item_category\" as \"item_category\",\n    friendly.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    friendly.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    friendly.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    friendly.\"store_sales_date_year\" as \"store_sales_date_year\",\n    viper.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\"\nFROM\n    friendly\n    LEFT OUTER JOIN viper on friendly.\"item_category\" = viper.\"item_category\"\nWHERE\n    friendly.\"store_sales_date_year\" = 2001 and friendly.\"store_sales_date_month_of_year\" = 1 and friendly.\"store_sales_item_current_price\" > 1.2 * viper.\"_virtual_6264207893106521\"\n),\nhelpless as (\nSELECT\n    magpie.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    magpie.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\",\n    magpie.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    magpie.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    magpie.\"store_sales_date_year\" as \"store_sales_date_year\",\n    fossa.\"customer_count\" as \"customer_count\"\nFROM\n    magpie\n    LEFT OUTER JOIN fossa on ((magpie.\"store_sales_customer_state\" is null and fossa.\"store_sales_customer_state\" is null) or (magpie.\"store_sales_customer_state\" = fossa.\"store_sales_customer_state\"))\nWHERE\n    magpie.\"store_sales_date_year\" = 2001 and magpie.\"store_sales_date_month_of_year\" = 1 and magpie.\"store_sales_item_current_price\" > 1.2 * magpie.\"_virtual_6264207893106521\"\n)\nSELECT\n    helpless.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    helpless.\"customer_count\" as \"customer_count\"\nFROM\n    helpless\nWHERE\n    helpless.\"customer_count\" > 10 and helpless.\"store_sales_date_year\" = 2001 and helpless.\"store_sales_date_month_of_year\" = 1 and helpless.\"store_sales_item_current_price\" > 1.2 * helpless.\"_virtual_6264207893106521\"\n\nGROUP BY \n    helpless.\"customer_count\",\n    helpless.\"store_sales_customer_state\"\nORDER BY \n    helpless.\"customer_count\" asc,\n    helpless.\"store_sales_customer_state\" asc"
}