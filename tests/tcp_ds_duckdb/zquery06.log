{
    "query_id": 6,
    "parse_time": 0.866384,
    "generation_time": 0.0,
    "exec_time": 2.082826,
    "comp_time": 0.35068,
    "total_time": 5.11754,
    "generated_sql": "\nWITH \nbadger as (\nSELECT\n    items.\"I_CURRENT_PRICE\" as \"item_current_price\",\n    items.\"I_CATEGORY\" as \"item_category\",\n    items.\"I_ITEM_SK\" as \"item_id\"\nFROM\n    memory.item as items\n),\nfriendly as (\nSELECT\n    avg(items.\"I_CURRENT_PRICE\") as \"_virtual_6264207893106521\",\n    items.\"I_CATEGORY\" as \"item_category\"\nFROM\n    memory.item as items\n\nGROUP BY \n    items.\"I_CATEGORY\"),\nowl as (\nSELECT\n    items.\"I_CURRENT_PRICE\" as \"store_sales_item_current_price\",\n    items.\"I_ITEM_SK\" as \"store_sales_item_id\"\nFROM\n    memory.item as items\n\nGROUP BY \n    items.\"I_CURRENT_PRICE\",\n    items.\"I_ITEM_SK\"),\ntiger as (\nSELECT\n    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\",\n    store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",\n    store_sales.\"SS_ITEM_SK\" as \"store_sales_item_id\"\nFROM\n    memory.store_sales as store_sales\n\nGROUP BY \n    store_sales.\"SS_CUSTOMER_SK\",\n    store_sales.\"SS_ITEM_SK\",\n    store_sales.\"SS_SOLD_DATE_SK\"),\nrambunctious as (\nSELECT\n    date.\"D_DATE_SK\" as \"store_sales_date_id\",\n    date.\"D_MOY\" as \"store_sales_date_month_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\ncrow as (\nSELECT\n    rambunctious.\"store_sales_date_id\" as \"store_sales_date_id\",\n    tiger.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    rambunctious.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    rambunctious.\"store_sales_date_year\" as \"store_sales_date_year\",\n    tiger.\"store_sales_item_id\" as \"store_sales_item_id\"\nFROM\n    tiger\n    LEFT OUTER JOIN rambunctious on tiger.\"store_sales_date_id\" = rambunctious.\"store_sales_date_id\"\n),\nraven as (\nSELECT\n    customer_address.\"CA_ADDRESS_SK\" as \"store_sales_customer_address_id\",\n    customer_address.\"CA_STATE\" as \"store_sales_customer_state\"\nFROM\n    memory.customer_address as customer_address\n),\nshrike as (\nSELECT\n    customers.\"C_CURRENT_ADDR_SK\" as \"store_sales_customer_address_id\",\n    customers.\"C_CUSTOMER_SK\" as \"store_sales_customer_id\"\nFROM\n    memory.customer as customers\n),\nmartin as (\nSELECT\n    shrike.\"store_sales_customer_address_id\" as \"store_sales_customer_address_id\",\n    shrike.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    raven.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    shrike\n    LEFT OUTER JOIN raven on shrike.\"store_sales_customer_address_id\" = raven.\"store_sales_customer_address_id\"\n),\nchimpanzee as (\nSELECT\n    martin.\"store_sales_customer_address_id\" as \"store_sales_customer_address_id\",\n    martin.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    martin.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    crow.\"store_sales_date_id\" as \"store_sales_date_id\",\n    crow.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    crow.\"store_sales_date_year\" as \"store_sales_date_year\",\n    owl.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    crow.\"store_sales_item_id\" as \"store_sales_item_id\"\nFROM\n    martin\n    LEFT OUTER JOIN crow on martin.\"store_sales_customer_id\" = crow.\"store_sales_customer_id\"\n    LEFT OUTER JOIN owl on crow.\"store_sales_item_id\" = owl.\"store_sales_item_id\"\n),\nswallow as (\nSELECT\n    badger.\"item_category\" as \"item_category\",\n    chimpanzee.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    chimpanzee.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    chimpanzee.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    chimpanzee.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    chimpanzee.\"store_sales_date_year\" as \"store_sales_date_year\"\nFROM\n    chimpanzee\n    LEFT OUTER JOIN badger on chimpanzee.\"store_sales_item_id\" = badger.\"item_id\"\n\nGROUP BY \n    chimpanzee.\"store_sales_date_month_of_year\",\n    chimpanzee.\"store_sales_customer_id\",\n    chimpanzee.\"store_sales_customer_state\",\n    chimpanzee.\"store_sales_item_current_price\",\n    chimpanzee.\"store_sales_date_year\",\n    badger.\"item_category\"),\nfaithful as (\nSELECT\n    swallow.\"item_category\" as \"item_category\",\n    swallow.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    swallow.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    swallow.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    swallow.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    swallow.\"store_sales_date_year\" as \"store_sales_date_year\",\n    friendly.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\"\nFROM\n    swallow\n    LEFT OUTER JOIN friendly on swallow.\"item_category\" = friendly.\"item_category\"\n),\nsweltering as (\nSELECT\n    CASE WHEN faithful.\"store_sales_date_year\" = 2001 and faithful.\"store_sales_date_month_of_year\" = 1 and faithful.\"store_sales_item_current_price\" > 1.2 * faithful.\"_virtual_6264207893106521\" THEN faithful.\"store_sales_customer_id\" ELSE NULL END as \"_virtual_947700376856737\",\n    faithful.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    faithful.\"store_sales_date_year\" as \"store_sales_date_year\",\n    faithful.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    faithful.\"store_sales_item_current_price\" as \"store_sales_item_current_price\",\n    faithful.\"_virtual_6264207893106521\" as \"_virtual_6264207893106521\",\n    faithful.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    faithful\n),\npremium as (\nSELECT\n    count(sweltering.\"_virtual_947700376856737\") as \"customer_count\",\n    sweltering.\"store_sales_customer_state\" as \"store_sales_customer_state\"\nFROM\n    sweltering\n\nGROUP BY \n    sweltering.\"store_sales_customer_state\")\n\nSELECT\n    premium.\"store_sales_customer_state\" as \"store_sales_customer_state\",\n    premium.\"customer_count\" as \"customer_count\"\nFROM\n    premium\nWHERE\n    premium.\"customer_count\" >= 10\n\nORDER BY \n    premium.\"customer_count\" asc,\n    premium.\"store_sales_customer_state\" asc\n"
}