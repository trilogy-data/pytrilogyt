{
    "query_id": 12,
    "parse_time": 3.882204,
    "generation_time": 0.0,
    "exec_time": 3.395087,
    "comp_time": 0.461525,
    "total_time": 11.911371,
    "sql_comp_time": 0.568876,
    "generated_sql": "\nWITH \nfaithful as (\nSELECT\n    web_sales.\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",\n    date.\"D_DATE\" as \"web_sales_date_date\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    web_sales.\"WS_ORDER_NUMBER\" as \"web_sales_order_number\",\n    web_sales.\"WS_ITEM_SK\" as \"web_sales_item_id\"\nFROM\n    memory.web_sales as web_sales\n    LEFT OUTER JOIN memory.date_dim as date on web_sales.\"WS_SOLD_DATE_SK\" = date.\"D_DATE_SK\"\n    LEFT OUTER JOIN memory.item as items on web_sales.\"WS_ITEM_SK\" = items.\"I_ITEM_SK\"),\npremium as (\nSELECT\n    CASE WHEN faithful.\"web_sales_date_date\" >= cast('1999-02-22' as date) and faithful.\"web_sales_date_date\" <= cast('1999-03-24' as date) and faithful.\"web_sales_item_category\" in ( 'Sports','Books','Home' ) THEN faithful.\"web_sales_external_sales_price\" ELSE NULL END as \"relevant_sales\",\n    faithful.\"web_sales_order_number\" as \"web_sales_order_number\",\n    faithful.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    faithful),\njay as (\nSELECT\n    premium.\"relevant_sales\" as \"relevant_sales\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\",\n    premium.\"web_sales_order_number\" as \"web_sales_order_number\",\n    premium.\"web_sales_item_id\" as \"web_sales_item_id\"\nFROM\n    premium\n    LEFT OUTER JOIN memory.item as items on premium.\"web_sales_item_id\" = items.\"I_ITEM_SK\"),\nheron as (\nSELECT\n    sum(jay.\"relevant_sales\") as \"itemrevenue\",\n    jay.\"web_sales_item_category\" as \"web_sales_item_category\",\n    jay.\"web_sales_item_class\" as \"web_sales_item_class\",\n    jay.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    jay.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    jay.\"web_sales_item_name\" as \"web_sales_item_name\",\n    sum(jay.\"relevant_sales\") as \"_virtual_1496978012803723\"\nFROM\n    jay\nGROUP BY \n    jay.\"web_sales_item_category\",\n    jay.\"web_sales_item_desc\",\n    jay.\"web_sales_item_class\",\n    jay.\"web_sales_item_name\",\n    jay.\"web_sales_item_current_price\"),\nvast as (\nSELECT\n    sum(jay.\"relevant_sales\") as \"_virtual_341251569527357\",\n    jay.\"web_sales_item_class\" as \"web_sales_item_class\"\nFROM\n    jay\nGROUP BY \n    jay.\"web_sales_item_class\"),\nquestionable as (\nSELECT\n    items.\"I_CLASS\" as \"web_sales_item_class\",\n    items.\"I_CATEGORY\" as \"web_sales_item_category\",\n    items.\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",\n    items.\"I_ITEM_DESC\" as \"web_sales_item_desc\",\n    items.\"I_ITEM_ID\" as \"web_sales_item_name\"\nFROM\n    memory.item as items\nGROUP BY \n    items.\"I_CATEGORY\",\n    items.\"I_CURRENT_PRICE\",\n    items.\"I_ITEM_ID\",\n    items.\"I_CLASS\",\n    items.\"I_ITEM_DESC\"),\nfox as (\nSELECT\n    questionable.\"web_sales_item_class\" as \"web_sales_item_class\",\n    questionable.\"web_sales_item_category\" as \"web_sales_item_category\",\n    questionable.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    questionable.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    questionable.\"web_sales_item_name\" as \"web_sales_item_name\",\n    vast.\"_virtual_341251569527357\" as \"_virtual_341251569527357\"\nFROM\n    questionable\n    LEFT OUTER JOIN vast on questionable.\"web_sales_item_class\" = vast.\"web_sales_item_class\"),\nruthless as (\nSELECT\n    heron.\"web_sales_item_category\" as \"web_sales_item_category\",\n    heron.\"web_sales_item_class\" as \"web_sales_item_class\",\n    heron.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    heron.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    heron.\"web_sales_item_name\" as \"web_sales_item_name\",\n    heron.\"_virtual_1496978012803723\" * 100.0 / fox.\"_virtual_341251569527357\" as \"revenueratio\"\nFROM\n    heron\n    LEFT OUTER JOIN fox on heron.\"web_sales_item_category\" = fox.\"web_sales_item_category\" AND heron.\"web_sales_item_class\" = fox.\"web_sales_item_class\" AND heron.\"web_sales_item_current_price\" = fox.\"web_sales_item_current_price\" AND heron.\"web_sales_item_desc\" = fox.\"web_sales_item_desc\" AND heron.\"web_sales_item_name\" = fox.\"web_sales_item_name\"),\nlevel as (\nSELECT\n    ruthless.\"web_sales_item_category\" as \"web_sales_item_category\",\n    ruthless.\"web_sales_item_class\" as \"web_sales_item_class\",\n    ruthless.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    ruthless.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    ruthless.\"web_sales_item_name\" as \"web_sales_item_name\",\n    ruthless.\"revenueratio\" as \"revenueratio\",\n    heron.\"itemrevenue\" as \"itemrevenue\"\nFROM\n    ruthless\n    LEFT OUTER JOIN heron on ruthless.\"web_sales_item_category\" = heron.\"web_sales_item_category\" AND ruthless.\"web_sales_item_class\" = heron.\"web_sales_item_class\" AND ruthless.\"web_sales_item_current_price\" = heron.\"web_sales_item_current_price\" AND ruthless.\"web_sales_item_desc\" = heron.\"web_sales_item_desc\" AND ruthless.\"web_sales_item_name\" = heron.\"web_sales_item_name\")\nSELECT\n    level.\"web_sales_item_name\" as \"web_sales_item_name\",\n    level.\"web_sales_item_desc\" as \"web_sales_item_desc\",\n    level.\"web_sales_item_category\" as \"web_sales_item_category\",\n    level.\"web_sales_item_class\" as \"web_sales_item_class\",\n    level.\"web_sales_item_current_price\" as \"web_sales_item_current_price\",\n    level.\"itemrevenue\" as \"itemrevenue\",\n    level.\"revenueratio\" as \"revenueratio\"\nFROM\n    level\nWHERE\n    level.\"itemrevenue\" is not null\n\nORDER BY \n    level.\"web_sales_item_category\" asc,\n    level.\"web_sales_item_class\" asc,\n    level.\"web_sales_item_name\" asc,\n    level.\"web_sales_item_desc\" asc,\n    level.\"revenueratio\" asc\nLIMIT (100)"
}