base_prep_time = 0.000167
base_parse_time = 0.063948
base_generation_time = 0.002692
base_exec_time = 0.014692
base_generated_sql = """

WITH 
cheerful as (
SELECT
    \"web_sales_item_items\".\"I_CATEGORY\" as \"web_sales_item_category\",
    \"web_sales_item_items\".\"I_CLASS\" as \"web_sales_item_class\",
    \"web_sales_item_items\".\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",
    \"web_sales_item_items\".\"I_ITEM_DESC\" as \"web_sales_item_desc\",
    \"web_sales_item_items\".\"I_ITEM_ID\" as \"web_sales_item_name\",
    \"web_sales_item_items\".\"I_ITEM_SK\" as \"web_sales_item_id\",
    \"web_sales_web_sales\".\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",
    \"web_sales_web_sales\".\"WS_ORDER_NUMBER\" as \"web_sales_order_number\"
FROM
    \"memory\".\"web_sales\" as \"web_sales_web_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"web_sales_date_date\" on \"web_sales_web_sales\".\"WS_SOLD_DATE_SK\" = \"web_sales_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"item\" as \"web_sales_item_items\" on \"web_sales_web_sales\".\"WS_ITEM_SK\" = \"web_sales_item_items\".\"I_ITEM_SK\"
WHERE
    cast(\"web_sales_date_date\".\"D_DATE\" as date) >= date '1999-02-22' and cast(\"web_sales_date_date\".\"D_DATE\" as date) <= date '1999-03-24' and \"web_sales_item_items\".\"I_CATEGORY\" in ('Sports','Books','Home')
),
thoughtful as (
SELECT
    \"cheerful\".\"web_sales_item_category\" as \"web_sales_item_category\",
    \"cheerful\".\"web_sales_item_class\" as \"web_sales_item_class\",
    \"cheerful\".\"web_sales_item_current_price\" as \"web_sales_item_current_price\",
    \"cheerful\".\"web_sales_item_desc\" as \"web_sales_item_desc\",
    \"cheerful\".\"web_sales_item_name\" as \"web_sales_item_name\",
    sum(\"cheerful\".\"web_sales_external_sales_price\") as \"itemrevenue\"
FROM
    \"cheerful\"
GROUP BY 
    \"cheerful\".\"web_sales_item_category\",
    \"cheerful\".\"web_sales_item_class\",
    \"cheerful\".\"web_sales_item_current_price\",
    \"cheerful\".\"web_sales_item_desc\",
    \"cheerful\".\"web_sales_item_name\"),
cooperative as (
SELECT
    \"thoughtful\".\"itemrevenue\" as \"itemrevenue\",
    \"thoughtful\".\"web_sales_item_class\" as \"web_sales_item_class\",
    sum(\"thoughtful\".\"itemrevenue\") over (partition by \"thoughtful\".\"web_sales_item_class\") as \"_virt_window_sum_7913040918303715\"
FROM
    \"thoughtful\")
SELECT
    \"thoughtful\".\"web_sales_item_name\" as \"web_sales_item_name\",
    \"thoughtful\".\"web_sales_item_desc\" as \"web_sales_item_desc\",
    \"thoughtful\".\"web_sales_item_category\" as \"web_sales_item_category\",
    \"thoughtful\".\"web_sales_item_class\" as \"web_sales_item_class\",
    \"thoughtful\".\"web_sales_item_current_price\" as \"web_sales_item_current_price\",
    \"thoughtful\".\"itemrevenue\" as \"itemrevenue\",
    (\"thoughtful\".\"itemrevenue\" * 100.0) / \"cooperative\".\"_virt_window_sum_7913040918303715\" as \"revenueratio\"
FROM
    \"cooperative\"
    LEFT OUTER JOIN \"thoughtful\" on \"cooperative\".\"itemrevenue\" = \"thoughtful\".\"itemrevenue\" AND (\"cooperative\".\"web_sales_item_class\" = \"thoughtful\".\"web_sales_item_class\" or (\"cooperative\".\"web_sales_item_class\" is null and \"thoughtful\".\"web_sales_item_class\" is null))
ORDER BY 
    \"thoughtful\".\"web_sales_item_category\" asc,
    \"thoughtful\".\"web_sales_item_class\" asc,
    \"thoughtful\".\"web_sales_item_name\" asc,
    \"thoughtful\".\"web_sales_item_desc\" asc,
    (\"thoughtful\".\"itemrevenue\" * 100.0) / \"cooperative\".\"_virt_window_sum_7913040918303715\" asc
LIMIT (100)"""
optimized_prep_time = 0.485587
optimized_parse_time = 0.172809
optimized_generation_time = 0.003949
optimized_exec_time = 0.011472
optimized_generated_sql = """

WITH 
scrawny as (
SELECT
    \"web_sales_item_items\".\"I_CATEGORY\" as \"web_sales_item_category\",
    \"web_sales_item_items\".\"I_CLASS\" as \"web_sales_item_class\",
    \"web_sales_item_items\".\"I_CURRENT_PRICE\" as \"web_sales_item_current_price\",
    \"web_sales_item_items\".\"I_ITEM_DESC\" as \"web_sales_item_desc\",
    \"web_sales_item_items\".\"I_ITEM_ID\" as \"web_sales_item_name\",
    \"web_sales_item_items\".\"I_ITEM_SK\" as \"web_sales_item_id\",
    \"web_sales_web_sales\".\"WS_EXT_SALES_PRICE\" as \"web_sales_external_sales_price\",
    \"web_sales_web_sales\".\"WS_ORDER_NUMBER\" as \"web_sales_order_number\"
FROM
    \"memory\".\"web_sales\" as \"web_sales_web_sales\"
    INNER JOIN \"memory\".\"date_dim\" as \"web_sales_date_date\" on \"web_sales_web_sales\".\"WS_SOLD_DATE_SK\" = \"web_sales_date_date\".\"D_DATE_SK\"
    INNER JOIN \"memory\".\"item\" as \"web_sales_item_items\" on \"web_sales_web_sales\".\"WS_ITEM_SK\" = \"web_sales_item_items\".\"I_ITEM_SK\"
WHERE
    ( cast(\"web_sales_date_date\".\"D_DATE\" as date) >= date '1999-02-22' and cast(\"web_sales_date_date\".\"D_DATE\" as date) <= date '1999-03-24' ) and \"web_sales_item_items\".\"I_CATEGORY\" in ('Sports','Books','Home')
),
friendly as (
SELECT
    \"scrawny\".\"web_sales_item_category\" as \"web_sales_item_category\",
    \"scrawny\".\"web_sales_item_class\" as \"web_sales_item_class\",
    \"scrawny\".\"web_sales_item_current_price\" as \"web_sales_item_current_price\",
    \"scrawny\".\"web_sales_item_desc\" as \"web_sales_item_desc\",
    \"scrawny\".\"web_sales_item_name\" as \"web_sales_item_name\",
    sum(\"scrawny\".\"web_sales_external_sales_price\") as \"itemrevenue\"
FROM
    \"scrawny\"
GROUP BY 
    \"scrawny\".\"web_sales_item_category\",
    \"scrawny\".\"web_sales_item_class\",
    \"scrawny\".\"web_sales_item_current_price\",
    \"scrawny\".\"web_sales_item_desc\",
    \"scrawny\".\"web_sales_item_name\"),
kaput as (
SELECT
    \"friendly\".\"itemrevenue\" as \"itemrevenue\",
    \"friendly\".\"web_sales_item_class\" as \"web_sales_item_class\",
    sum(\"friendly\".\"itemrevenue\") over (partition by \"friendly\".\"web_sales_item_class\") as \"_virt_window_sum_7913040918303715\"
FROM
    \"friendly\")
SELECT
    \"friendly\".\"web_sales_item_name\" as \"web_sales_item_name\",
    \"friendly\".\"web_sales_item_desc\" as \"web_sales_item_desc\",
    \"friendly\".\"web_sales_item_category\" as \"web_sales_item_category\",
    \"friendly\".\"web_sales_item_class\" as \"web_sales_item_class\",
    \"friendly\".\"web_sales_item_current_price\" as \"web_sales_item_current_price\",
    \"friendly\".\"itemrevenue\" as \"itemrevenue\",
    (\"friendly\".\"itemrevenue\" * 100.0) / \"kaput\".\"_virt_window_sum_7913040918303715\" as \"revenueratio\"
FROM
    \"kaput\"
    LEFT OUTER JOIN \"friendly\" on \"kaput\".\"itemrevenue\" = \"friendly\".\"itemrevenue\" AND \"kaput\".\"web_sales_item_class\" = \"friendly\".\"web_sales_item_class\"
ORDER BY 
    \"friendly\".\"web_sales_item_category\" asc,
    \"friendly\".\"web_sales_item_class\" asc,
    \"friendly\".\"web_sales_item_name\" asc,
    \"friendly\".\"web_sales_item_desc\" asc,
    (\"friendly\".\"itemrevenue\" * 100.0) / \"kaput\".\"_virt_window_sum_7913040918303715\" asc
LIMIT (100)"""
query_id = 12
sql_comp_time = 0.01649
total_time = 0.780323
