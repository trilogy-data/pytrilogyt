base_prep_time = 0.000267
base_parse_time = 9.140972
base_generation_time = 0.007016
base_exec_time = 0.216905
base_generated_sql = """

WITH 
thoughtful as (
SELECT
    store_sales_store_sales.\"SS_CUSTOMER_SK\" as \"customer_id\",
    store_sales_store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\"
FROM
    memory.store_sales as store_sales_store_sales
GROUP BY 
    store_sales_store_sales.\"SS_CUSTOMER_SK\",
    store_sales_store_sales.\"SS_SOLD_DATE_SK\"),
abundant as (
SELECT
    web_sales_web_sales.\"WS_BILL_CUSTOMER_SK\" as \"customer_id\",
    web_sales_web_sales.\"WS_SOLD_DATE_SK\" as \"web_sales_date_id\"
FROM
    memory.web_sales as web_sales_web_sales
GROUP BY 
    web_sales_web_sales.\"WS_BILL_CUSTOMER_SK\",
    web_sales_web_sales.\"WS_SOLD_DATE_SK\"),
juicy as (
SELECT
    catalog_sales_catalog_sales.\"CS_SHIP_CUSTOMER_SK\" as \"customer_id\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
GROUP BY 
    catalog_sales_catalog_sales.\"CS_SHIP_CUSTOMER_SK\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\"),
vacuous as (
SELECT
    customer_customers.\"C_CUSTOMER_SK\" as \"relevant_customers\"
FROM
    memory.customer as customer_customers
    LEFT OUTER JOIN juicy on customer_customers.\"C_CUSTOMER_SK\" = juicy.\"customer_id\"
    LEFT OUTER JOIN thoughtful on customer_customers.\"C_CUSTOMER_SK\" = thoughtful.\"customer_id\"
    LEFT OUTER JOIN abundant on customer_customers.\"C_CUSTOMER_SK\" = abundant.\"customer_id\"
    LEFT OUTER JOIN memory.date_dim as web_sales_date_date on abundant.\"web_sales_date_id\" = web_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.customer_address as customer_customer_address on customer_customers.\"C_CURRENT_ADDR_SK\" = customer_customer_address.\"CA_ADDRESS_SK\"
    LEFT OUTER JOIN memory.date_dim as store_sales_date_date on thoughtful.\"store_sales_date_id\" = store_sales_date_date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as catalog_sales_date_date on juicy.\"catalog_sales_date_id\" = catalog_sales_date_date.\"D_DATE_SK\"
WHERE
    cast(store_sales_date_date.\"D_YEAR\" as int) = 2002 and store_sales_date_date.\"D_MOY\" in (1,2,3,4) and ( ( cast(web_sales_date_date.\"D_YEAR\" as int) = 2002 and web_sales_date_date.\"D_MOY\" in (1,2,3,4) ) or ( cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2002 and catalog_sales_date_date.\"D_MOY\" in (1,2,3,4) ) ) and customer_customer_address.\"CA_COUNTY\" in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County')
),
concerned as (
SELECT
    vacuous.\"relevant_customers\" as \"relevant_customers\"
FROM
    vacuous
GROUP BY 
    vacuous.\"relevant_customers\"),
young as (
SELECT
    customer_customers.\"C_CUSTOMER_SK\" as \"base_customer_id\",
    customer_demographics_customer_demographics.\"CD_CREDIT_RATING\" as \"base_customer_demographics_credit_rating\",
    customer_demographics_customer_demographics.\"CD_DEMO_SK\" as \"base_customer_demographics_id\",
    customer_demographics_customer_demographics.\"CD_DEP_COLLEGE_COUNT\" as \"base_customer_demographics_college_dependent_count\",
    customer_demographics_customer_demographics.\"CD_DEP_COUNT\" as \"base_customer_demographics_dependent_count\",
    customer_demographics_customer_demographics.\"CD_DEP_EMPLOYED_COUNT\" as \"base_customer_demographics_employed_dependent_count\",
    customer_demographics_customer_demographics.\"CD_EDUCATION_STATUS\" as \"base_customer_demographics_education_status\",
    customer_demographics_customer_demographics.\"CD_GENDER\" as \"base_customer_demographics_gender\",
    customer_demographics_customer_demographics.\"CD_MARITAL_STATUS\" as \"base_customer_demographics_marital_status\",
    customer_demographics_customer_demographics.\"CD_PURCHASE_ESTIMATE\" as \"base_customer_demographics_purchase_estimate\"
FROM
    memory.customer_demographics as customer_demographics_customer_demographics
    INNER JOIN memory.customer as customer_customers on customer_demographics_customer_demographics.\"CD_DEMO_SK\" = customer_customers.\"C_CURRENT_CDEMO_SK\"
WHERE
    customer_customers.\"C_CUSTOMER_SK\" in (select concerned.\"relevant_customers\" from concerned where concerned.\"relevant_customers\" is not null) and customer_demographics_customer_demographics.\"CD_GENDER\" is not null
)
SELECT
    young.\"base_customer_demographics_gender\" as \"base_customer_demographics_gender\",
    young.\"base_customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",
    young.\"base_customer_demographics_education_status\" as \"base_customer_demographics_education_status\",
    count(young.\"base_customer_id\") as \"cnt1\",
    young.\"base_customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",
    count(young.\"base_customer_id\") as \"cnt2\",
    young.\"base_customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",
    count(young.\"base_customer_id\") as \"cnt3\",
    young.\"base_customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",
    count(young.\"base_customer_id\") as \"cnt4\",
    young.\"base_customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",
    count(young.\"base_customer_id\") as \"cnt5\",
    young.\"base_customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\",
    count(young.\"base_customer_id\") as \"cnt6\"
FROM
    young
GROUP BY 
    young.\"base_customer_demographics_college_dependent_count\",
    young.\"base_customer_demographics_credit_rating\",
    young.\"base_customer_demographics_dependent_count\",
    young.\"base_customer_demographics_education_status\",
    young.\"base_customer_demographics_employed_dependent_count\",
    young.\"base_customer_demographics_gender\",
    young.\"base_customer_demographics_marital_status\",
    young.\"base_customer_demographics_purchase_estimate\"
ORDER BY 
    young.\"base_customer_demographics_gender\" asc,
    young.\"base_customer_demographics_marital_status\" asc,
    young.\"base_customer_demographics_education_status\" asc,
    young.\"base_customer_demographics_purchase_estimate\" asc,
    young.\"base_customer_demographics_credit_rating\" asc,
    young.\"base_customer_demographics_dependent_count\" asc,
    young.\"base_customer_demographics_employed_dependent_count\" asc,
    young.\"base_customer_demographics_college_dependent_count\" asc"""
optimized_prep_time = 1.651722
optimized_parse_time = 29.613597
optimized_generation_time = 0.007452
optimized_exec_time = 0.220815
optimized_generated_sql = """

WITH 
busy as (
SELECT
    store_sales_store_sales.\"SS_CUSTOMER_SK\" as \"customer_id\",
    store_sales_store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\"
FROM
    memory.store_sales as store_sales_store_sales
GROUP BY 
    store_sales_store_sales.\"SS_CUSTOMER_SK\",
    store_sales_store_sales.\"SS_SOLD_DATE_SK\"),
premium as (
SELECT
    web_sales_web_sales.\"WS_BILL_CUSTOMER_SK\" as \"customer_id\",
    web_sales_web_sales.\"WS_SOLD_DATE_SK\" as \"web_sales_date_id\"
FROM
    memory.web_sales as web_sales_web_sales
GROUP BY 
    web_sales_web_sales.\"WS_BILL_CUSTOMER_SK\",
    web_sales_web_sales.\"WS_SOLD_DATE_SK\"),
rambunctious as (
SELECT
    catalog_sales_catalog_sales.\"CS_SHIP_CUSTOMER_SK\" as \"customer_id\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\"
FROM
    memory.catalog_sales as catalog_sales_catalog_sales
GROUP BY 
    catalog_sales_catalog_sales.\"CS_SHIP_CUSTOMER_SK\",
    catalog_sales_catalog_sales.\"CS_SOLD_DATE_SK\"),
puffy as (
SELECT
    customer_customers.\"C_CUSTOMER_SK\" as \"relevant_customers\"
FROM
    memory.customer as customer_customers
    LEFT OUTER JOIN rambunctious on customer_customers.\"C_CUSTOMER_SK\" = rambunctious.\"customer_id\"
    LEFT OUTER JOIN busy on customer_customers.\"C_CUSTOMER_SK\" = busy.\"customer_id\"
    LEFT OUTER JOIN premium on customer_customers.\"C_CUSTOMER_SK\" = premium.\"customer_id\"
    LEFT OUTER JOIN memory.date_dim as web_sales_date_date on premium.\"web_sales_date_id\" = web_sales_date_date.\"D_DATE_SK\"
    INNER JOIN memory.customer_address as customer_customer_address on customer_customers.\"C_CURRENT_ADDR_SK\" = customer_customer_address.\"CA_ADDRESS_SK\"
    LEFT OUTER JOIN memory.date_dim as store_sales_date_date on busy.\"store_sales_date_id\" = store_sales_date_date.\"D_DATE_SK\"
    LEFT OUTER JOIN memory.date_dim as catalog_sales_date_date on rambunctious.\"catalog_sales_date_id\" = catalog_sales_date_date.\"D_DATE_SK\"
WHERE
    cast(store_sales_date_date.\"D_YEAR\" as int) = 2002 and ( store_sales_date_date.\"D_MOY\" in (1,2,3,4) and ( ( ( ( ( cast(web_sales_date_date.\"D_YEAR\" as int) = 2002 and web_sales_date_date.\"D_MOY\" in (1,2,3,4) ) ) or ( ( cast(catalog_sales_date_date.\"D_YEAR\" as int) = 2002 and catalog_sales_date_date.\"D_MOY\" in (1,2,3,4) ) ) ) ) and customer_customer_address.\"CA_COUNTY\" in ('Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County') ) )
),
hard as (
SELECT
    puffy.\"relevant_customers\" as \"relevant_customers\"
FROM
    puffy
GROUP BY 
    puffy.\"relevant_customers\"),
sedate as (
SELECT
    customer_customers.\"C_CUSTOMER_SK\" as \"base_customer_id\",
    customer_demographics_customer_demographics.\"CD_CREDIT_RATING\" as \"base_customer_demographics_credit_rating\",
    customer_demographics_customer_demographics.\"CD_DEMO_SK\" as \"base_customer_demographics_id\",
    customer_demographics_customer_demographics.\"CD_DEP_COLLEGE_COUNT\" as \"base_customer_demographics_college_dependent_count\",
    customer_demographics_customer_demographics.\"CD_DEP_COUNT\" as \"base_customer_demographics_dependent_count\",
    customer_demographics_customer_demographics.\"CD_DEP_EMPLOYED_COUNT\" as \"base_customer_demographics_employed_dependent_count\",
    customer_demographics_customer_demographics.\"CD_EDUCATION_STATUS\" as \"base_customer_demographics_education_status\",
    customer_demographics_customer_demographics.\"CD_GENDER\" as \"base_customer_demographics_gender\",
    customer_demographics_customer_demographics.\"CD_MARITAL_STATUS\" as \"base_customer_demographics_marital_status\",
    customer_demographics_customer_demographics.\"CD_PURCHASE_ESTIMATE\" as \"base_customer_demographics_purchase_estimate\"
FROM
    memory.customer_demographics as customer_demographics_customer_demographics
    INNER JOIN memory.customer as customer_customers on customer_demographics_customer_demographics.\"CD_DEMO_SK\" = customer_customers.\"C_CURRENT_CDEMO_SK\"
WHERE
    customer_customers.\"C_CUSTOMER_SK\" in (select hard.\"relevant_customers\" from hard where hard.\"relevant_customers\" is not null) and customer_demographics_customer_demographics.\"CD_GENDER\" is not null
)
SELECT
    sedate.\"base_customer_demographics_gender\" as \"base_customer_demographics_gender\",
    sedate.\"base_customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",
    sedate.\"base_customer_demographics_education_status\" as \"base_customer_demographics_education_status\",
    count(sedate.\"base_customer_id\") as \"cnt1\",
    sedate.\"base_customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",
    count(sedate.\"base_customer_id\") as \"cnt2\",
    sedate.\"base_customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",
    count(sedate.\"base_customer_id\") as \"cnt3\",
    sedate.\"base_customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",
    count(sedate.\"base_customer_id\") as \"cnt4\",
    sedate.\"base_customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",
    count(sedate.\"base_customer_id\") as \"cnt5\",
    sedate.\"base_customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\",
    count(sedate.\"base_customer_id\") as \"cnt6\"
FROM
    sedate
GROUP BY 
    sedate.\"base_customer_demographics_college_dependent_count\",
    sedate.\"base_customer_demographics_credit_rating\",
    sedate.\"base_customer_demographics_dependent_count\",
    sedate.\"base_customer_demographics_education_status\",
    sedate.\"base_customer_demographics_employed_dependent_count\",
    sedate.\"base_customer_demographics_gender\",
    sedate.\"base_customer_demographics_marital_status\",
    sedate.\"base_customer_demographics_purchase_estimate\"
ORDER BY 
    sedate.\"base_customer_demographics_gender\" asc,
    sedate.\"base_customer_demographics_marital_status\" asc,
    sedate.\"base_customer_demographics_education_status\" asc,
    sedate.\"base_customer_demographics_purchase_estimate\" asc,
    sedate.\"base_customer_demographics_credit_rating\" asc,
    sedate.\"base_customer_demographics_dependent_count\" asc,
    sedate.\"base_customer_demographics_employed_dependent_count\" asc,
    sedate.\"base_customer_demographics_college_dependent_count\" asc"""
query_id = 10
sql_comp_time = 0.266004
total_time = 41.134199
