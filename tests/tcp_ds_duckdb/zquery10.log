{
    "query_id": 10,
    "parse_time": 21.667286,
    "generation_time": 0.0,
    "exec_time": 0.757139,
    "comp_time": 0.871843,
    "total_time": 23.992508,
    "generated_sql": "\nWITH \nrambunctious as (\nSELECT\n    date.\"D_MOY\" as \"store_sales_date_month_of_year\",\n    date.\"D_DATE_SK\" as \"store_sales_date_id\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\nlion as (\nSELECT\n    store_sales.\"SS_CUSTOMER_SK\" as \"store_sales_customer_id\",\n    store_sales.\"SS_SOLD_DATE_SK\" as \"store_sales_date_id\"\nFROM\n    memory.store_sales as store_sales\n\nGROUP BY \n    store_sales.\"SS_CUSTOMER_SK\",\n    store_sales.\"SS_SOLD_DATE_SK\"),\nlate as (\nSELECT\n    lion.\"store_sales_customer_id\" as \"store_sales_customer_id\",\n    lion.\"store_sales_date_id\" as \"store_sales_date_id\",\n    rambunctious.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    rambunctious.\"store_sales_date_year\" as \"store_sales_date_year\"\nFROM\n    lion\n    LEFT OUTER JOIN rambunctious on lion.\"store_sales_date_id\" = rambunctious.\"store_sales_date_id\"\n),\nleopard as (\nSELECT\n    customer_address.\"CA_ADDRESS_SK\" as \"customer_address_id\",\n    customer_address.\"CA_COUNTY\" as \"customer_county\"\nFROM\n    memory.customer_address as customer_address\n),\nkaput as (\nSELECT\n    customers.\"C_CURRENT_ADDR_SK\" as \"customer_address_id\",\n    customers.\"C_CUSTOMER_SK\" as \"customer_id\",\n    customers.\"C_CURRENT_CDEMO_SK\" as \"customer_demographics_id\"\nFROM\n    memory.customer as customers\n),\nabundant as (\nSELECT\n    kaput.\"customer_address_id\" as \"customer_address_id\",\n    leopard.\"customer_county\" as \"customer_county\",\n    kaput.\"customer_id\" as \"customer_id\"\nFROM\n    kaput\n    LEFT OUTER JOIN leopard on kaput.\"customer_address_id\" = leopard.\"customer_address_id\"\n),\nflashy as (\nSELECT\n    date.\"D_MOY\" as \"catalog_sales_date_month_of_year\",\n    date.\"D_DATE_SK\" as \"catalog_sales_date_id\",\n    cast(\"D_YEAR\" as int) as \"catalog_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\nchick as (\nSELECT\n    customers.\"C_CUSTOMER_SK\" as \"catalog_sales_customer_id\"\nFROM\n    memory.customer as customers\n\nGROUP BY \n    customers.\"C_CUSTOMER_SK\"),\ndapper as (\nSELECT\n    chick.\"catalog_sales_customer_id\" as \"catalog_sales_customer_id\",\n    catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\"\nFROM\n    memory.catalog_sales as catalog_sales\n    FULL JOIN chick on catalog_sales.\"CS_SHIP_CUSTOMER_SK\" = chick.\"catalog_sales_customer_id\"\n\nGROUP BY \n    chick.\"catalog_sales_customer_id\",\n    catalog_sales.\"CS_SOLD_DATE_SK\"),\neminent as (\nSELECT\n    dapper.\"catalog_sales_customer_id\" as \"catalog_sales_customer_id\",\n    dapper.\"catalog_sales_date_id\" as \"catalog_sales_date_id\",\n    flashy.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",\n    flashy.\"catalog_sales_date_year\" as \"catalog_sales_date_year\"\nFROM\n    flashy\n    LEFT OUTER JOIN dapper on flashy.\"catalog_sales_date_id\" = dapper.\"catalog_sales_date_id\"\n),\ncoyote as (\nSELECT\n    date.\"D_MOY\" as \"web_sales_date_month_of_year\",\n    date.\"D_DATE_SK\" as \"web_sales_date_id\",\n    cast(\"D_YEAR\" as int) as \"web_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\nmacaw as (\nSELECT\n    customers.\"C_CUSTOMER_SK\" as \"web_sales_customer_id\"\nFROM\n    memory.customer as customers\n\nGROUP BY \n    customers.\"C_CUSTOMER_SK\"),\ncanary as (\nSELECT\n    macaw.\"web_sales_customer_id\" as \"web_sales_customer_id\",\n    web_sales.\"WS_SOLD_DATE_SK\" as \"web_sales_date_id\"\nFROM\n    memory.web_sales as web_sales\n    FULL JOIN macaw on web_sales.\"WS_BILL_CUSTOMER_SK\" = macaw.\"web_sales_customer_id\"\n\nGROUP BY \n    web_sales.\"WS_SOLD_DATE_SK\",\n    macaw.\"web_sales_customer_id\"),\nabstracted as (\nSELECT\n    canary.\"web_sales_customer_id\" as \"web_sales_customer_id\",\n    canary.\"web_sales_date_id\" as \"web_sales_date_id\",\n    coyote.\"web_sales_date_month_of_year\" as \"web_sales_date_month_of_year\",\n    coyote.\"web_sales_date_year\" as \"web_sales_date_year\"\nFROM\n    coyote\n    LEFT OUTER JOIN canary on coyote.\"web_sales_date_id\" = canary.\"web_sales_date_id\"\n),\npuzzled as (\nSELECT\n    abundant.\"customer_id\" as \"customer_id\",\n    late.\"store_sales_date_year\" as \"store_sales_date_year\",\n    late.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    abstracted.\"web_sales_date_year\" as \"web_sales_date_year\",\n    abstracted.\"web_sales_date_month_of_year\" as \"web_sales_date_month_of_year\",\n    eminent.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",\n    eminent.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",\n    abundant.\"customer_county\" as \"customer_county\"\nFROM\n    abundant\n    LEFT OUTER JOIN eminent on abundant.\"customer_id\" = eminent.\"catalog_sales_customer_id\"\n    LEFT OUTER JOIN abstracted on abundant.\"customer_id\" = abstracted.\"web_sales_customer_id\"\n    LEFT OUTER JOIN late on abundant.\"customer_id\" = late.\"store_sales_customer_id\"\n\nGROUP BY \n    late.\"store_sales_date_month_of_year\",\n    eminent.\"catalog_sales_date_month_of_year\",\n    abundant.\"customer_county\",\n    abundant.\"customer_id\",\n    abstracted.\"web_sales_date_month_of_year\",\n    eminent.\"catalog_sales_date_year\",\n    late.\"store_sales_date_year\",\n    abstracted.\"web_sales_date_year\"),\njay as (\nSELECT\n    CASE WHEN puzzled.\"store_sales_date_year\" = 2002 and puzzled.\"store_sales_date_month_of_year\" in ( 1,2,3,4 ) and ( ( puzzled.\"web_sales_date_year\" = 2002 and puzzled.\"web_sales_date_month_of_year\" in ( 1,2,3,4 ) ) or ( puzzled.\"catalog_sales_date_year\" = 2002 and puzzled.\"catalog_sales_date_month_of_year\" in ( 1,2,3,4 ) ) ) and puzzled.\"customer_county\" in ( 'Rush County','Toole County','Jefferson County','Dona Ana County','La Porte County' ) THEN puzzled.\"customer_id\" ELSE NULL END as \"relevant_customers\",\n    puzzled.\"customer_id\" as \"customer_id\",\n    puzzled.\"store_sales_date_year\" as \"store_sales_date_year\",\n    puzzled.\"store_sales_date_month_of_year\" as \"store_sales_date_month_of_year\",\n    puzzled.\"web_sales_date_year\" as \"web_sales_date_year\",\n    puzzled.\"web_sales_date_month_of_year\" as \"web_sales_date_month_of_year\",\n    puzzled.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",\n    puzzled.\"catalog_sales_date_month_of_year\" as \"catalog_sales_date_month_of_year\",\n    puzzled.\"customer_county\" as \"customer_county\"\nFROM\n    puzzled\n),\nstork as (\nSELECT\n    customer_demographics.\"CD_DEP_COLLEGE_COUNT\" as \"customer_demographics_college_dependent_count\",\n    customer_demographics.\"CD_CREDIT_RATING\" as \"customer_demographics_credit_rating\",\n    customer_demographics.\"CD_DEP_COUNT\" as \"customer_demographics_dependent_count\",\n    customer_demographics.\"CD_EDUCATION_STATUS\" as \"customer_demographics_education_status\",\n    customer_demographics.\"CD_DEP_EMPLOYED_COUNT\" as \"customer_demographics_employed_dependent_count\",\n    customer_demographics.\"CD_GENDER\" as \"customer_demographics_gender\",\n    customer_demographics.\"CD_DEMO_SK\" as \"customer_demographics_id\",\n    customer_demographics.\"CD_MARITAL_STATUS\" as \"customer_demographics_marital_status\",\n    customer_demographics.\"CD_PURCHASE_ESTIMATE\" as \"customer_demographics_purchase_estimate\"\nFROM\n    memory.customer_demographics as customer_demographics\n),\nexuberant as (\nSELECT\n    stork.\"customer_demographics_college_dependent_count\" as \"customer_demographics_college_dependent_count\",\n    stork.\"customer_demographics_credit_rating\" as \"customer_demographics_credit_rating\",\n    stork.\"customer_demographics_dependent_count\" as \"customer_demographics_dependent_count\",\n    stork.\"customer_demographics_education_status\" as \"customer_demographics_education_status\",\n    stork.\"customer_demographics_employed_dependent_count\" as \"customer_demographics_employed_dependent_count\",\n    stork.\"customer_demographics_gender\" as \"customer_demographics_gender\",\n    stork.\"customer_demographics_id\" as \"customer_demographics_id\",\n    stork.\"customer_demographics_marital_status\" as \"customer_demographics_marital_status\",\n    stork.\"customer_demographics_purchase_estimate\" as \"customer_demographics_purchase_estimate\",\n    kaput.\"customer_id\" as \"customer_id\"\nFROM\n    stork\n    LEFT OUTER JOIN kaput on stork.\"customer_demographics_id\" = kaput.\"customer_demographics_id\"\n),\ncheerful as (\nSELECT\n    exuberant.\"customer_id\" as \"base_customer_id\",\n    exuberant.\"customer_demographics_gender\" as \"base_customer_demographics_gender\",\n    exuberant.\"customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",\n    exuberant.\"customer_demographics_education_status\" as \"base_customer_demographics_education_status\",\n    exuberant.\"customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",\n    exuberant.\"customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",\n    exuberant.\"customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",\n    exuberant.\"customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",\n    exuberant.\"customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\"\nFROM\n    exuberant\nWHERE\n    exuberant.\"customer_id\" in (select jay.\"relevant_customers\" from jay where jay.\"relevant_customers\" is not null)\n\nGROUP BY \n    exuberant.\"customer_demographics_credit_rating\",\n    exuberant.\"customer_demographics_dependent_count\",\n    exuberant.\"customer_demographics_gender\",\n    exuberant.\"customer_id\",\n    exuberant.\"customer_demographics_marital_status\",\n    exuberant.\"customer_demographics_employed_dependent_count\",\n    exuberant.\"customer_demographics_college_dependent_count\",\n    exuberant.\"customer_demographics_education_status\",\n    exuberant.\"customer_demographics_purchase_estimate\")\n\nSELECT\n    cheerful.\"base_customer_demographics_gender\" as \"base_customer_demographics_gender\",\n    cheerful.\"base_customer_demographics_marital_status\" as \"base_customer_demographics_marital_status\",\n    cheerful.\"base_customer_demographics_education_status\" as \"base_customer_demographics_education_status\",\n    count(cheerful.\"base_customer_id\") as \"cnt1\",\n    cheerful.\"base_customer_demographics_purchase_estimate\" as \"base_customer_demographics_purchase_estimate\",\n    count(cheerful.\"base_customer_id\") as \"cnt2\",\n    cheerful.\"base_customer_demographics_credit_rating\" as \"base_customer_demographics_credit_rating\",\n    count(cheerful.\"base_customer_id\") as \"cnt3\",\n    cheerful.\"base_customer_demographics_dependent_count\" as \"base_customer_demographics_dependent_count\",\n    count(cheerful.\"base_customer_id\") as \"cnt4\",\n    cheerful.\"base_customer_demographics_employed_dependent_count\" as \"base_customer_demographics_employed_dependent_count\",\n    count(cheerful.\"base_customer_id\") as \"cnt5\",\n    cheerful.\"base_customer_demographics_college_dependent_count\" as \"base_customer_demographics_college_dependent_count\",\n    count(cheerful.\"base_customer_id\") as \"cnt6\"\nFROM\n    cheerful\n\nGROUP BY \n    cheerful.\"base_customer_demographics_purchase_estimate\",\n    cheerful.\"base_customer_demographics_credit_rating\",\n    cheerful.\"base_customer_demographics_dependent_count\",\n    cheerful.\"base_customer_demographics_gender\",\n    cheerful.\"base_customer_demographics_employed_dependent_count\",\n    cheerful.\"base_customer_demographics_marital_status\",\n    cheerful.\"base_customer_demographics_college_dependent_count\",\n    cheerful.\"base_customer_demographics_education_status\"\nORDER BY \n    cheerful.\"base_customer_demographics_gender\" asc,\n    cheerful.\"base_customer_demographics_marital_status\" asc,\n    cheerful.\"base_customer_demographics_education_status\" asc,\n    cheerful.\"base_customer_demographics_purchase_estimate\" asc,\n    cheerful.\"base_customer_demographics_credit_rating\" asc,\n    cheerful.\"base_customer_demographics_dependent_count\" asc,\n    cheerful.\"base_customer_demographics_employed_dependent_count\" asc,\n    cheerful.\"base_customer_demographics_college_dependent_count\" asc\n"
}