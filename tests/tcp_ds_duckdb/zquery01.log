{
    "query_id": 1,
    "parse_time": 1.032872,
    "generation_time": 0.0,
    "exec_time": 0.365281,
    "comp_time": 0.099553,
    "total_time": 1.814596,
    "generated_sql": "\nWITH \ndingo as (\nSELECT\n    store.\"S_STATE\" as \"returns_store_state\",\n    store.\"S_STORE_SK\" as \"returns_store_id\"\nFROM\n    memory.store as store\n),\nthoughtful as (\nSELECT\n    cast(\"D_YEAR\" as int) as \"returns_return_date_year\",\n    date.\"D_DATE_SK\" as \"returns_return_date_id\"\nFROM\n    memory.date_dim as date\n),\npintail as (\nSELECT\n    customers.\"C_CUSTOMER_SK\" as \"returns_customer_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\"\nFROM\n    memory.customer as customers\n),\nshark as (\nSELECT\n    store_returns.\"SR_CUSTOMER_SK\" as \"returns_customer_id\",\n    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\",\n    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",\n    store_returns.\"SR_RETURNED_DATE_SK\" as \"returns_return_date_id\",\n    store_returns.\"SR_STORE_SK\" as \"returns_store_id\",\n    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\"\nFROM\n    memory.store_returns as store_returns\n),\nthrush as (\nSELECT\n    shark.\"returns_customer_id\" as \"returns_customer_id\",\n    pintail.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    shark.\"returns_item_id\" as \"returns_item_id\",\n    shark.\"returns_return_amount\" as \"returns_return_amount\",\n    shark.\"returns_return_date_id\" as \"returns_return_date_id\",\n    shark.\"returns_store_id\" as \"returns_store_id\",\n    shark.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"\nFROM\n    shark\n    LEFT OUTER JOIN pintail on shark.\"returns_customer_id\" = pintail.\"returns_customer_id\"\n),\npuffin as (\nSELECT\n    thrush.\"returns_customer_id\" as \"returns_customer_id\",\n    thrush.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    thrush.\"returns_item_id\" as \"returns_item_id\",\n    thrush.\"returns_return_amount\" as \"returns_return_amount\",\n    thrush.\"returns_return_date_id\" as \"returns_return_date_id\",\n    thoughtful.\"returns_return_date_year\" as \"returns_return_date_year\",\n    thrush.\"returns_store_id\" as \"returns_store_id\",\n    dingo.\"returns_store_state\" as \"returns_store_state\",\n    thrush.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\"\nFROM\n    thrush\n    LEFT OUTER JOIN thoughtful on thrush.\"returns_return_date_id\" = thoughtful.\"returns_return_date_id\"\n    LEFT OUTER JOIN dingo on thrush.\"returns_store_id\" = dingo.\"returns_store_id\"\n),\nsparrow as (\nSELECT\n    CASE WHEN puffin.\"returns_return_date_year\" = 2000 and puffin.\"returns_store_state\" = 'TN' THEN puffin.\"returns_return_amount\" ELSE NULL END as \"_virtual_9694543044139401\",\n    puffin.\"returns_return_amount\" as \"returns_return_amount\",\n    puffin.\"returns_return_date_year\" as \"returns_return_date_year\",\n    puffin.\"returns_store_state\" as \"returns_store_state\",\n    puffin.\"returns_store_id\" as \"returns_store_id\",\n    puffin.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    puffin.\"returns_store_sales_ticket_number\" as \"returns_store_sales_ticket_number\",\n    puffin.\"returns_item_id\" as \"returns_item_id\"\nFROM\n    puffin\n),\ncolossal as (\nSELECT\n    sum(sparrow.\"_virtual_9694543044139401\") as \"total_returns\",\n    sparrow.\"returns_store_id\" as \"returns_store_id\",\n    sparrow.\"returns_customer_text_id\" as \"returns_customer_text_id\",\n    sparrow.\"returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    sparrow.\"returns_store_id\" as \"tn_2000_returns_store_id\",\n    sum(sparrow.\"_virtual_9694543044139401\") as \"tn_2000_total_returns\"\nFROM\n    sparrow\n\nGROUP BY \n    sparrow.\"returns_store_id\",\n    sparrow.\"returns_customer_text_id\"),\nfowl as (\nSELECT\n    avg(colossal.\"tn_2000_total_returns\") as \"avg_store_returns\",\n    colossal.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\"\nFROM\n    colossal\n\nGROUP BY \n    colossal.\"tn_2000_returns_store_id\"),\nrook as (\nSELECT\n    colossal.\"tn_2000_returns_store_id\" as \"tn_2000_returns_store_id\",\n    colossal.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    fowl.\"avg_store_returns\" as \"avg_store_returns\"\nFROM\n    colossal\n    LEFT OUTER JOIN fowl on colossal.\"tn_2000_returns_store_id\" = fowl.\"tn_2000_returns_store_id\"\nWHERE\n    colossal.\"tn_2000_total_returns\" > ( 1.2 * fowl.\"avg_store_returns\" )\n),\nslow as (\nSELECT\n    colossal.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\",\n    colossal.\"tn_2000_total_returns\" as \"tn_2000_total_returns\",\n    rook.\"avg_store_returns\" as \"avg_store_returns\"\nFROM\n    colossal\n    LEFT OUTER JOIN rook on colossal.\"tn_2000_returns_store_id\" = rook.\"tn_2000_returns_store_id\" AND colossal.\"tn_2000_total_returns\" = rook.\"tn_2000_total_returns\"\nWHERE\n    colossal.\"tn_2000_total_returns\" > ( 1.2 * rook.\"avg_store_returns\" )\n\nGROUP BY \n    colossal.\"tn_2000_total_returns\",\n    colossal.\"tn_2000_returns_customer_text_id\",\n    rook.\"avg_store_returns\")\n\nSELECT\n    slow.\"tn_2000_returns_customer_text_id\" as \"tn_2000_returns_customer_text_id\"\nFROM\n    slow\n\nORDER BY \n    slow.\"tn_2000_returns_customer_text_id\" asc\nLIMIT (100)\n"
}