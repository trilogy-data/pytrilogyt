{
    "base_parse_time": 1.976526,
    "base_generation_time": 0.015643,
    "base_exec_time": 0.094352,
    "base_generated_sql": "\nWITH \ncheerful as (\nSELECT\n    store_returns.\"SR_RETURN_AMT\" as \"returns_return_amount\",\n    store.\"S_STATE\" as \"returns_store_state\",\n    cast(\"D_YEAR\" as int) as \"returns_return_date_year\",\n    store.\"S_STORE_SK\" as \"returns_store_id\",\n    customers.\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",\n    store_returns.\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\",\n    store_returns.\"SR_ITEM_SK\" as \"returns_item_id\"\nFROM\n    memory.customer as customers\n    INNER JOIN memory.store_returns as store_returns on customers.\"C_CUSTOMER_SK\" = store_returns.\"SR_CUSTOMER_SK\"\n    INNER JOIN memory.date_dim as date on store_returns.\"SR_RETURNED_DATE_SK\" = date.\"D_DATE_SK\"\n    INNER JOIN memory.store as store on store_returns.\"SR_STORE_SK\" = store.\"S_STORE_SK\"\nWHERE\n    store.\"S_STATE\" = 'TN' and cast(\"D_YEAR\" as int) = 2000\n),\nthoughtful as (\nSELECT\n    sum(cheerful.\"returns_return_amount\") as \"total_returns\",\n    cheerful.\"returns_store_id\" as \"returns_store_id\",\n    cheerful.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    cheerful\nGROUP BY \n    cheerful.\"returns_customer_text_id\",\n    cheerful.\"returns_store_id\"),\ncooperative as (\nSELECT\n    avg(thoughtful.\"total_returns\") as \"avg_store_returns\",\n    thoughtful.\"returns_store_id\" as \"returns_store_id\"\nFROM\n    thoughtful\nGROUP BY \n    thoughtful.\"returns_store_id\")\nSELECT\n    thoughtful.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    cooperative\n    INNER JOIN thoughtful on cooperative.\"returns_store_id\" = thoughtful.\"returns_store_id\"\nWHERE\n    thoughtful.\"total_returns\" > ( 1.2 * cooperative.\"avg_store_returns\" )\n\nORDER BY \n    thoughtful.\"returns_customer_text_id\" asc\nLIMIT (100)",
    "optimized_parse_time": 17.562532,
    "optimized_generation_time": 0.006984,
    "optimized_exec_time": 0.14459,
    "optimized_generated_sql": "\nWITH \nscrawny as (\nSELECT\n    sum(id_id_text_id_ticket_number_year_89f0b8d713089ca2e55d9cd2b6b95850e1993d319eeffff7af06fb57ab6fa8bd_filtered_on_state_year.\"returns_return_amount\") as \"total_returns\",\n    id_id_text_id_ticket_number_year_89f0b8d713089ca2e55d9cd2b6b95850e1993d319eeffff7af06fb57ab6fa8bd_filtered_on_state_year.\"returns_store_id\" as \"returns_store_id\",\n    id_id_text_id_ticket_number_year_89f0b8d713089ca2e55d9cd2b6b95850e1993d319eeffff7af06fb57ab6fa8bd_filtered_on_state_year.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    id_id_text_id_ticket_number_year_89f0b8d713089ca2e55d9cd2b6b95850e1993d319eeffff7af06fb57ab6fa8bd_filtered_on_state_year\nGROUP BY \n    id_id_text_id_ticket_number_year_89f0b8d713089ca2e55d9cd2b6b95850e1993d319eeffff7af06fb57ab6fa8bd_filtered_on_state_year.\"returns_store_id\",\n    id_id_text_id_ticket_number_year_89f0b8d713089ca2e55d9cd2b6b95850e1993d319eeffff7af06fb57ab6fa8bd_filtered_on_state_year.\"returns_customer_text_id\"),\nfriendly as (\nSELECT\n    avg(scrawny.\"total_returns\") as \"avg_store_returns\",\n    scrawny.\"returns_store_id\" as \"returns_store_id\"\nFROM\n    scrawny\nGROUP BY \n    scrawny.\"returns_store_id\")\nSELECT\n    scrawny.\"returns_customer_text_id\" as \"returns_customer_text_id\"\nFROM\n    friendly\n    INNER JOIN scrawny on friendly.\"returns_store_id\" = scrawny.\"returns_store_id\"\nWHERE\n    scrawny.\"total_returns\" > ( 1.2 * friendly.\"avg_store_returns\" )\n\nORDER BY \n    scrawny.\"returns_customer_text_id\" asc\nLIMIT (100)",
    "query_id": 1,
    "sql_comp_time": 2.610496,
    "total_time": 22.428253
}