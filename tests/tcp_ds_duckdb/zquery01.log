{
    "query_id": 1,
    "parse_time": 8.654196,
    "generation_time": 0.007524,
    "exec_time": 1.017238,
    "comp_time": 2.148451,
    "total_time": 11.829787,
    "generated_sql": "\nWITH \nswift as (\nSELECT\n    date.D_DATE_SK as \"returns_return_date_id\",\n    cast(\"D_YEAR\" as int) as \"returns_return_date_year\"\nFROM\n    memory.date_dim as date\n),\neel as (\nSELECT\n    store_returns.SR_RETURN_AMT as \"returns_return_amount\",\n    swift.returns_return_date_year as \"returns_return_date_year\",\n    store.S_STATE as \"returns_store_state\",\n    coalesce(store_returns.SR_STORE_SK,store.S_STORE_SK) as \"returns_store_id\",\n    customers.C_CUSTOMER_ID as \"returns_customer_text_id\",\n    store_returns.SR_TICKET_NUMBER as \"returns_store_sales_ticket_number\",\n    store_returns.SR_ITEM_SK as \"returns_item_id\"\nFROM\n    memory.store_returns as store_returns\n    LEFT OUTER JOIN swift on store_returns.\"SR_RETURNED_DATE_SK\" = swift.\"returns_return_date_id\"\n    LEFT OUTER JOIN memory.store as store on store_returns.\"SR_STORE_SK\" = store.\"S_STORE_SK\"\n    LEFT OUTER JOIN memory.customer as customers on store_returns.\"SR_CUSTOMER_SK\" = customers.\"C_CUSTOMER_SK\"\n),\ndynamic as (\nSELECT\n    CASE WHEN ( eel.returns_return_date_year = 2000 and eel.returns_store_state = 'TN' )  THEN eel.returns_return_amount ELSE NULL END as \"_virtual_1598721530382553\",\n    eel.returns_return_amount as \"returns_return_amount\",\n    eel.returns_return_date_year as \"returns_return_date_year\",\n    eel.returns_store_state as \"returns_store_state\",\n    eel.returns_store_id as \"returns_store_id\",\n    eel.returns_customer_text_id as \"returns_customer_text_id\",\n    eel.returns_store_sales_ticket_number as \"returns_store_sales_ticket_number\",\n    eel.returns_item_id as \"returns_item_id\"\nFROM\n    eel as eel\n),\nflashy as (\nSELECT\n    sum(dynamic._virtual_1598721530382553) as \"total_returns\",\n    dynamic.returns_store_id as \"returns_store_id\",\n    dynamic.returns_customer_text_id as \"returns_customer_text_id\",\n    dynamic.returns_customer_text_id as \"tn_2000_returns_customer_text_id\",\n    dynamic.returns_store_id as \"tn_2000_returns_store_id\",\n    sum(dynamic._virtual_1598721530382553) as \"tn_2000_total_returns\"\nFROM\n    dynamic as dynamic\n\nGROUP BY \n    dynamic.returns_store_id,\n    dynamic.returns_customer_text_id),\ncanary as (\nSELECT\n    avg(flashy.tn_2000_total_returns) as \"avg_store_returns\",\n    flashy.tn_2000_returns_store_id as \"tn_2000_returns_store_id\"\nFROM\n    flashy as flashy\n\nGROUP BY \n    flashy.tn_2000_returns_store_id),\nceaseless as (\nSELECT\n    coalesce(flashy.tn_2000_returns_store_id,canary.tn_2000_returns_store_id) as \"tn_2000_returns_store_id\",\n    flashy.tn_2000_total_returns as \"tn_2000_total_returns\",\n    canary.avg_store_returns as \"avg_store_returns\"\nFROM\n    flashy as flashy\n    LEFT OUTER JOIN canary on flashy.\"tn_2000_returns_store_id\" = canary.\"tn_2000_returns_store_id\"\n),\nkomodo as (\nSELECT\n    flashy.tn_2000_returns_customer_text_id as \"tn_2000_returns_customer_text_id\",\n    coalesce(flashy.tn_2000_total_returns,ceaseless.tn_2000_total_returns) as \"tn_2000_total_returns\",\n    ceaseless.avg_store_returns as \"avg_store_returns\"\nFROM\n    flashy as flashy\n    LEFT OUTER JOIN ceaseless on flashy.\"tn_2000_returns_store_id\" = ceaseless.\"tn_2000_returns_store_id\" AND flashy.\"tn_2000_total_returns\" = ceaseless.\"tn_2000_total_returns\"\n\nGROUP BY \n    coalesce(flashy.tn_2000_total_returns,ceaseless.tn_2000_total_returns),\n    ceaseless.avg_store_returns,\n    flashy.tn_2000_returns_customer_text_id)\nSELECT\n    komodo.\"tn_2000_returns_customer_text_id\"\nFROM\n    komodo\nWHERE\n    komodo.\"tn_2000_total_returns\" > ( (1.2 * komodo.\"avg_store_returns\") ) \n\nORDER BY \n    komodo.\"tn_2000_returns_customer_text_id\" asc\n\nLIMIT (100)"
}