base_prep_time = 0.000213
base_parse_time = 0.163608
base_generation_time = 0.001839
base_exec_time = 0.053961
base_generated_sql = """

WITH 
thoughtful as (
SELECT
    \"returns_customer_customers\".\"C_CUSTOMER_ID\" as \"returns_customer_text_id\",
    \"returns_store_returns\".\"SR_ITEM_SK\" as \"returns_item_id\",
    \"returns_store_returns\".\"SR_RETURN_AMT\" as \"returns_return_amount\",
    \"returns_store_returns\".\"SR_TICKET_NUMBER\" as \"returns_store_sales_ticket_number\",
    \"returns_store_store\".\"S_STORE_SK\" as \"returns_store_id\"
FROM
    \"memory\".\"store_returns\" as \"returns_store_returns\"
    INNER JOIN \"memory\".\"store\" as \"returns_store_store\" on \"returns_store_returns\".\"SR_STORE_SK\" = \"returns_store_store\".\"S_STORE_SK\"
    INNER JOIN \"memory\".\"customer\" as \"returns_customer_customers\" on \"returns_store_returns\".\"SR_CUSTOMER_SK\" = \"returns_customer_customers\".\"C_CUSTOMER_SK\"
    INNER JOIN \"memory\".\"date_dim\" as \"returns_return_date_date\" on \"returns_store_returns\".\"SR_RETURNED_DATE_SK\" = \"returns_return_date_date\".\"D_DATE_SK\"
WHERE
    \"returns_store_store\".\"S_STATE\" = 'TN' and cast(\"returns_return_date_date\".\"D_YEAR\" as int) = 2000
),
cooperative as (
SELECT
    \"thoughtful\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"thoughtful\".\"returns_store_id\" as \"returns_store_id\",
    sum(\"thoughtful\".\"returns_return_amount\") as \"total_returns\"
FROM
    \"thoughtful\"
GROUP BY 
    \"thoughtful\".\"returns_customer_text_id\",
    \"thoughtful\".\"returns_store_id\"),
questionable as (
SELECT
    \"cooperative\".\"returns_store_id\" as \"returns_store_id\",
    avg(\"cooperative\".\"total_returns\") as \"avg_store_returns\"
FROM
    \"cooperative\"
GROUP BY 
    \"cooperative\".\"returns_store_id\")
SELECT
    \"cooperative\".\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    \"questionable\"
    INNER JOIN \"cooperative\" on \"questionable\".\"returns_store_id\" = \"cooperative\".\"returns_store_id\"
WHERE
    \"cooperative\".\"total_returns\" > ( 1.2 * \"questionable\".\"avg_store_returns\" )

ORDER BY 
    \"cooperative\".\"returns_customer_text_id\" asc
LIMIT (100)"""
optimized_prep_time = 638.212118
optimized_parse_time = 10.310898
optimized_generation_time = 0.422568
optimized_exec_time = 2.879873
optimized_generated_sql = """

WITH 
late as (
SELECT
    \"default_dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\".\"returns_customer_text_id\" as \"returns_customer_text_id\",
    \"default_dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\".\"returns_store_id\" as \"returns_store_id\",
    sum(\"default_dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\".\"returns_return_amount\") as \"total_returns\"
FROM
    \"dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\" as \"default_dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\"
GROUP BY 
    \"default_dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\".\"returns_customer_text_id\",
    \"default_dsa09b549514982e2f5ebaf23a4352f002a4259c548b06c2eac32969c3a097f293_filtered_on_state_year\".\"returns_store_id\"),
macho as (
SELECT
    \"late\".\"returns_store_id\" as \"returns_store_id\",
    avg(\"late\".\"total_returns\") as \"avg_store_returns\"
FROM
    \"late\"
GROUP BY 
    \"late\".\"returns_store_id\")
SELECT
    \"late\".\"returns_customer_text_id\" as \"returns_customer_text_id\"
FROM
    \"macho\"
    INNER JOIN \"late\" on \"macho\".\"returns_store_id\" = \"late\".\"returns_store_id\"
WHERE
    \"late\".\"total_returns\" > ( 1.2 * \"macho\".\"avg_store_returns\" )

ORDER BY 
    \"late\".\"returns_customer_text_id\" asc
LIMIT (100)"""
query_id = 1
sql_comp_time = 4.559098
total_time = 657.680964
