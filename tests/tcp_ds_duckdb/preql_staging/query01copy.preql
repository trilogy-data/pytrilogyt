# Generated from .preql source: query01copy.preql
# Do not edit manually; direct changes to this file will be overwritten
# this import is added by optimization 
import _internal_cached_intermediates_ebcd717811e83ccd7fe5a2b5836236d8ffc9d80befa5e01352673338783b87ac_datasources;


import store_returns as returns;


WHERE
    returns.store.state = 'TN' and returns.return_date.year = 2000
SELECT
    returns.customer.text_id,
    --sum(returns.return_amount) -> total_returns,
    --returns.store.id,
    --avg(total_returns) by returns.store.id -> avg_store_returns,
HAVING
    total_returns > (1.2 * avg_store_returns)

ORDER BY
    returns.customer.text_id asc
LIMIT 100
;