# Generated from .preql source: query06.preql
# Do not edit manually; direct changes to this file will be overwritten
# this import is added by optimization 
import _internal_cached_intermediates_dd569285d3d5d9bca0b72809224fd4b4c9d87e3dc8507d42de03d24928f4a3e0_datasources;


import store_sales as store_sales;
import item as item;


MERGE store_sales.item.id into item.id;


WHERE
    store_sales.date.year = 2001 and (store_sales.date.month_of_year = 1 and (store_sales.item.current_price > 1.2 * avg(item.current_price) by item.category and item.category is not null))
SELECT
    store_sales.customer.state,
    count(store_sales.customer.id) -> customer_count,
HAVING
    customer_count >= 10

ORDER BY
    customer_count asc nulls first,
    store_sales.customer.state asc nulls first
;