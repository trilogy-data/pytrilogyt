{
    "query_id": 8,
    "parse_time": 7.477928,
    "generation_time": 0.00907,
    "exec_time": 7.450725,
    "comp_time": 0.291893,
    "total_time": 15.229616,
    "generated_sql": "\nWITH \ndove as (\nSELECT\n    customers.C_CUSTOMER_SK as \"customer_id\",\n    customers.C_PREFERRED_CUST_FLAG as \"customer_preferred_cust_flag\",\n    customer_address.CA_ZIP as \"customer_zip\"\nFROM\n    memory.customer as customers\n    LEFT OUTER JOIN memory.customer_address as customer_address on customers.\"C_CURRENT_ADDR_SK\" = customer_address.\"CA_ADDRESS_SK\"\n),\nserval as (\nSELECT\n    CASE WHEN customers.C_PREFERRED_CUST_FLAG = 'Y' THEN customers.C_CUSTOMER_SK ELSE NULL END as \"_virtual_7470647693515630\",\n    customers.C_CUSTOMER_SK as \"customer_id\",\n    customers.C_PREFERRED_CUST_FLAG as \"customer_preferred_cust_flag\"\nFROM\n    memory.customer as customers\n),\nsparrow as (\nSELECT\n    serval._virtual_7470647693515630 as \"_virtual_7470647693515630\",\n    dove.customer_zip as \"customer_zip\"\nFROM\n    dove as dove\n    LEFT OUTER JOIN serval on dove.\"customer_id\" = serval.\"customer_id\"\n\nGROUP BY \n    serval._virtual_7470647693515630,\n    dove.customer_zip),\nyoung as (\nSELECT\n    count(sparrow._virtual_7470647693515630) as \"zip_p_count\",\n    sparrow.customer_zip as \"customer_zip\"\nFROM\n    sparrow as sparrow\n\nGROUP BY \n    sparrow.customer_zip),\nwarbler as (\nSELECT\n    coalesce(customer_address.CA_ZIP,young.customer_zip) as \"customer_zip\",\n    customer_address.CA_ADDRESS_SK as \"customer_address_id\",\n    young.zip_p_count as \"zip_p_count\"\nFROM\n    memory.customer_address as customer_address\n    LEFT OUTER JOIN young on customer_address.\"CA_ZIP\" = young.\"customer_zip\"\n),\njackal as (\nSELECT\n    CASE WHEN warbler.zip_p_count > 10 THEN warbler.customer_zip ELSE NULL END as \"p_cust_zip\",\n    warbler.customer_zip as \"customer_zip\",\n    warbler.zip_p_count as \"zip_p_count\",\n    warbler.customer_address_id as \"customer_address_id\"\nFROM\n    warbler as warbler\n),\nflamingo as (\nSELECT\n    SUBSTRING(jackal.p_cust_zip,1,5) as \"_virtual_1342571877656287\"\nFROM\n    jackal as jackal\n\nGROUP BY \n    SUBSTRING(jackal.p_cust_zip,1,5)),\nduck as (\nSELECT\n    [24128,76232,65084,87816,83926,77556,20548,26231,43848,15126,91137,61265,98294,25782,17920,18426,98235,40081,84093,28577,55565,17183,54601,67897,22752,86284,18376,38607,45200,21756,29741,96765,23932,89360,29839,25989,28898,91068,72550,10390,18845,47770,82636,41367,76638,86198,81312,37126,39192,88424,72175,81426,53672,10445,42666,66864,66708,41248,48583,82276,18842,78890,49448,14089,38122,34425,79077,19849,43285,39861,66162,77610,13695,99543,83444,83041,12305,57665,68341,25003,57834,62878,49130,81096,18840,27700,23470,50412,21195,16021,76107,71954,68309,18119,98359,64544,10336,86379,27068,39736,98569,28915,24206,56529,57647,54917,42961,91110,63981,14922,36420,23006,67467,32754,30903,20260,31671,51798,72325,85816,68621,13955,36446,41766,68806,16725,15146,22744,35850,88086,51649,18270,52867,39972,96976,63792,11376,94898,13595,10516,90225,58943,39371,94945,28587,96576,57855,28488,26105,83933,25858,34322,44438,73171,30122,34102,22685,71256,78451,54364,13354,45375,40558,56458,28286,45266,47305,69399,83921,26233,11101,15371,69913,35942,15882,25631,24610,44165,99076,33786,70738,26653,14328,72305,62496,22152,10144,64147,48425,14663,21076,18799,30450,63089,81019,68893,24996,51200,51211,45692,92712,70466,79994,22437,25280,38935,71791,73134,56571,14060,19505,72425,56575,74351,68786,51650,20004,18383,76614,11634,18906,15765,41368,73241,76698,78567,97189,28545,76231,75691,22246,51061,90578,56691,68014,51103,94167,57047,14867,73520,15734,63435,25733,35474,24676,94627,53535,17879,15559,53268,59166,11928,59402,33282,45721,43933,68101,33515,36634,71286,19736,58058,55253,67473,41918,19515,36495,19430,22351,77191,91393,49156,50298,87501,18652,53179,18767,63193,23968,65164,68880,21286,72823,58470,67301,13394,31016,70372,67030,40604,24317,45748,39127,26065,77721,31029,31880,60576,24671,45549,13376,50016,33123,19769,22927,97789,46081,72151,15723,46136,51949,68100,96888,64528,14171,79777,28709,11489,25103,32213,78668,22245,15798,27156,37930,62971,21337,51622,67853,10567,38415,15455,58263,42029,60279,37125,56240,88190,50308,26859,64457,89091,82136,62377,36233,63837,58078,17043,30010,60099,28810,98025,29178,87343,73273,30469,64034,39516,86057,21309,90257,67875,40162,11356,73650,61810,72013,30431,22461,19512,13375,55307,30625,83849,68908,26689,96451,38193,46820,88885,84935,69035,83144,47537,56616,94983,48033,69952,25486,61547,27385,61860,58048,56910,16807,17871,35258,31387,35458,35576] as \"zips_pre\"\n\n),\nowl as (\nSELECT\n    SUBSTRING(cast(unnest(duck.zips_pre) as string),1,5) as \"zips\"\nFROM\n    duck as duck\n),\ncloudy as (\nSELECT\n    CASE WHEN owl.zips in (select flamingo._virtual_1342571877656287 from flamingo) THEN owl.zips ELSE NULL END as \"_virtual_9322816127174477\",\n    owl.zips as \"zips\"\nFROM\n    owl as owl\n),\ntiger as (\nSELECT\n    SUBSTRING(cloudy._virtual_9322816127174477,1,2) as \"final_zips\"\nFROM\n    cloudy as cloudy\n\nGROUP BY \n    SUBSTRING(cloudy._virtual_9322816127174477,1,2)),\nodd as (\nSELECT\n    date.D_DATE_SK as \"store_sales_date_id\",\n    date.D_QOY as \"store_sales_date_quarter_of_year\",\n    cast(\"D_YEAR\" as int) as \"store_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\nsloppy as (\nSELECT\n    store_sales.SS_NET_PROFIT as \"store_sales_net_profit\",\n    store_sales.SS_SOLD_DATE_SK as \"store_sales_date_id\",\n    store.S_STORE_SK as \"store_sales_store_id\",\n    store_sales.SS_TICKET_NUMBER as \"store_sales_ticket_number\",\n    store_sales.SS_ITEM_SK as \"store_sales_item_id\"\nFROM\n    memory.store_sales as store_sales\n    FULL JOIN memory.store as store on store_sales.\"SS_STORE_SK\" = store.\"S_STORE_SK\"\n),\nturkey as (\nSELECT\n    sloppy.store_sales_net_profit as \"store_sales_net_profit\",\n    odd.store_sales_date_quarter_of_year as \"store_sales_date_quarter_of_year\",\n    odd.store_sales_date_year as \"store_sales_date_year\",\n    store.S_ZIP as \"store_sales_store_zip\",\n    store.S_STORE_NAME as \"store_sales_store_name\",\n    sloppy.store_sales_ticket_number as \"store_sales_ticket_number\",\n    sloppy.store_sales_item_id as \"store_sales_item_id\"\nFROM\n    sloppy as sloppy\n    LEFT OUTER JOIN odd on sloppy.\"store_sales_date_id\" = odd.\"store_sales_date_id\"\n    LEFT OUTER JOIN memory.store as store on sloppy.\"store_sales_store_id\" = store.\"S_STORE_SK\"\n\nGROUP BY \n    odd.store_sales_date_quarter_of_year,\n    sloppy.store_sales_ticket_number,\n    store.S_STORE_NAME,\n    sloppy.store_sales_item_id,\n    odd.store_sales_date_year,\n    sloppy.store_sales_net_profit,\n    store.S_ZIP),\nheron as (\nSELECT\n    CASE WHEN ( turkey.store_sales_date_quarter_of_year = 2 and ( turkey.store_sales_date_year = 1998 and SUBSTRING(turkey.store_sales_store_zip,1,2) in (select tiger.final_zips from tiger) )  )  THEN turkey.store_sales_net_profit ELSE NULL END as \"_virtual_7098533545612532\",\n    turkey.store_sales_net_profit as \"store_sales_net_profit\",\n    turkey.store_sales_date_quarter_of_year as \"store_sales_date_quarter_of_year\",\n    turkey.store_sales_date_year as \"store_sales_date_year\",\n    turkey.store_sales_store_zip as \"store_sales_store_zip\",\n    turkey.store_sales_store_name as \"store_sales_store_name\",\n    turkey.store_sales_ticket_number as \"store_sales_ticket_number\",\n    turkey.store_sales_item_id as \"store_sales_item_id\"\nFROM\n    turkey as turkey\n),\nboa as (\nSELECT\n    sum(heron._virtual_7098533545612532) as \"store_net_profit\",\n    heron.store_sales_store_name as \"store_sales_store_name\"\nFROM\n    heron as heron\n\nGROUP BY \n    heron.store_sales_store_name)\nSELECT\n    boa.\"store_sales_store_name\",\n    boa.\"store_net_profit\"\nFROM\n    boa\nWHERE\n    boa.\"store_net_profit\" is not null\n\nORDER BY \n    boa.\"store_sales_store_name\" asc\n\nLIMIT (100)"
}