{
    "query_id": 15,
    "parse_time": 0.578891,
    "generation_time": 0.020514,
    "exec_time": 0.659167,
    "comp_time": 0.198204,
    "total_time": 2.071047,
    "generated_sql": "\nWITH \ngoose as (\nSELECT\n    customer_address.\"CA_ADDRESS_SK\" as \"catalog_sales_bill_customer_address_id\",\n    customer_address.\"CA_STATE\" as \"catalog_sales_bill_customer_state\",\n    customer_address.\"CA_ZIP\" as \"catalog_sales_bill_customer_zip\"\nFROM\n    memory.customer_address as customer_address\n),\nraven as (\nSELECT\n    customers.\"C_CUSTOMER_SK\" as \"catalog_sales_bill_customer_id\",\n    customers.\"C_CURRENT_ADDR_SK\" as \"catalog_sales_bill_customer_address_id\"\nFROM\n    memory.customer as customers\n),\npenguin as (\nSELECT\n    date.\"D_DATE_SK\" as \"catalog_sales_date_id\",\n    date.\"D_QOY\" as \"catalog_sales_date_quarter\",\n    cast(\"D_YEAR\" as int) as \"catalog_sales_date_year\"\nFROM\n    memory.date_dim as date\n),\nuneven as (\nSELECT\n    catalog_sales.\"CS_SALES_PRICE\" as \"catalog_sales_sales_price\",\n    catalog_sales.\"CS_SOLD_DATE_SK\" as \"catalog_sales_date_id\",\n    catalog_sales.\"CS_BILL_CUSTOMER_SK\" as \"catalog_sales_bill_customer_id\",\n    catalog_sales.\"CS_ORDER_NUMBER\" as \"catalog_sales_order_number\",\n    catalog_sales.\"CS_ITEM_SK\" as \"catalog_sales_item_id\"\nFROM\n    memory.catalog_sales as catalog_sales\n),\nfox as (\nSELECT\n    uneven.\"catalog_sales_sales_price\" as \"catalog_sales_sales_price\",\n    uneven.\"catalog_sales_date_id\" as \"catalog_sales_date_id\",\n    raven.\"catalog_sales_bill_customer_id\" as \"catalog_sales_bill_customer_id\",\n    uneven.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",\n    uneven.\"catalog_sales_item_id\" as \"catalog_sales_item_id\"\nFROM\n    uneven\n    FULL JOIN raven on uneven.\"catalog_sales_bill_customer_id\" = raven.\"catalog_sales_bill_customer_id\"\n),\nimported as (\nSELECT\n    fox.\"catalog_sales_sales_price\" as \"catalog_sales_sales_price\",\n    penguin.\"catalog_sales_date_quarter\" as \"catalog_sales_date_quarter\",\n    penguin.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",\n    goose.\"catalog_sales_bill_customer_state\" as \"catalog_sales_bill_customer_state\",\n    goose.\"catalog_sales_bill_customer_zip\" as \"catalog_sales_bill_customer_zip\",\n    fox.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",\n    fox.\"catalog_sales_item_id\" as \"catalog_sales_item_id\"\nFROM\n    fox\n    LEFT OUTER JOIN penguin on fox.\"catalog_sales_date_id\" = penguin.\"catalog_sales_date_id\"\n    LEFT OUTER JOIN raven on fox.\"catalog_sales_bill_customer_id\" = raven.\"catalog_sales_bill_customer_id\"\n    LEFT OUTER JOIN goose on raven.\"catalog_sales_bill_customer_address_id\" = goose.\"catalog_sales_bill_customer_address_id\"\n\nGROUP BY \n    goose.\"catalog_sales_bill_customer_state\",\n    fox.\"catalog_sales_order_number\",\n    fox.\"catalog_sales_sales_price\",\n    penguin.\"catalog_sales_date_quarter\",\n    fox.\"catalog_sales_item_id\",\n    goose.\"catalog_sales_bill_customer_zip\",\n    penguin.\"catalog_sales_date_year\"),\nstarling as (\nSELECT\n    CASE WHEN imported.\"catalog_sales_date_quarter\" = 2 and imported.\"catalog_sales_date_year\" = 2001 and ( imported.\"catalog_sales_bill_customer_state\" in ( 'CA','WA','GA' ) or imported.\"catalog_sales_sales_price\" > 500 or SUBSTRING(imported.\"catalog_sales_bill_customer_zip\",1,5) in ( '85669','86197','88274','83405','86475','85392','85460','80348','81792' ) ) THEN imported.\"catalog_sales_sales_price\" ELSE NULL END as \"relevant_sales\",\n    imported.\"catalog_sales_sales_price\" as \"catalog_sales_sales_price\",\n    imported.\"catalog_sales_date_quarter\" as \"catalog_sales_date_quarter\",\n    imported.\"catalog_sales_date_year\" as \"catalog_sales_date_year\",\n    imported.\"catalog_sales_bill_customer_state\" as \"catalog_sales_bill_customer_state\",\n    imported.\"catalog_sales_bill_customer_zip\" as \"catalog_sales_bill_customer_zip\",\n    imported.\"catalog_sales_order_number\" as \"catalog_sales_order_number\",\n    imported.\"catalog_sales_item_id\" as \"catalog_sales_item_id\"\nFROM\n    imported\n),\nlark as (\nSELECT\n    sum(starling.\"relevant_sales\") as \"sales\",\n    starling.\"catalog_sales_bill_customer_zip\" as \"catalog_sales_bill_customer_zip\"\nFROM\n    starling\n\nGROUP BY \n    starling.\"catalog_sales_bill_customer_zip\")\nSELECT\n    lark.\"catalog_sales_bill_customer_zip\",\n    lark.\"sales\"\nFROM\n    lark\nWHERE\n    lark.\"sales\" is not null\n\nORDER BY \n    lark.\"catalog_sales_bill_customer_zip\" asc nulls first\nLIMIT (100)"
}