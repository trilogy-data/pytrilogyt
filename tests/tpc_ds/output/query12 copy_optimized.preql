import _opt_web_sales_caeb4e8d;

WHERE
    web_sales.date.date >= '1999-02-22'::date and web_sales.date.date <= '1999-03-24'::date and web_sales.item.category in ('Sports', 'Books', 'Home')
SELECT
    web_sales.item.name,
    web_sales.item.desc,
    web_sales.item.category,
    web_sales.item.class,
    web_sales.item.current_price,
    sum(web_sales.extra_sales_price) -> itemrevenue,
    --sum itemrevenue over web_sales.item.class -> itemclassrevenue,
    (itemrevenue * 100.0) / itemclassrevenue -> revenueratio,
ORDER BY
    web_sales.item.category asc,
    web_sales.item.class asc,
    web_sales.item.name asc,
    web_sales.item.desc asc,
    revenueratio asc
LIMIT 100
;

WHERE
    web_sales.date.date >= '1999-02-22'::date and web_sales.date.date <= '1999-03-24'::date and web_sales.item.category in ('Sports', 'Books', 'Home')
SELECT
    web_sales.item.name,
    web_sales.item.desc,
    web_sales.item.category,
    web_sales.item.class,
    web_sales.item.current_price,
    sum(web_sales.extra_sales_price) -> itemrevenue,
    --sum itemrevenue over web_sales.item.class -> itemclassrevenue,
    (itemrevenue * 100.0) / itemclassrevenue -> revenueratio,
ORDER BY
    web_sales.item.category asc,
    web_sales.item.class asc,
    web_sales.item.name asc,
    web_sales.item.desc asc,
    revenueratio asc
LIMIT 100
;