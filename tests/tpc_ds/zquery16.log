{
    "query_id": 16,
    "parse_time": 9.122635,
    "generation_time": 0.0,
    "exec_time": 1.991339,
    "comp_time": 0.090891,
    "total_time": 13.073848,
    "sql_comp_time": 0.077568,
    "generated_sql": "\nWITH \nyoung as (\nSELECT\n    warehouse.\"w_warehouse_sk\" as \"cs_warehouse_id\"\nFROM\n    memory.warehouse as warehouse\n),\nobsolete as (\nSELECT\n    catalog_sales.\"CS_ORDER_NUMBER\" as \"cs_order_number\",\n    catalog_sales.\"CS_WAREHOUSE_SK\" as \"cs_warehouse_id\",\n    catalog_sales.\"CS_SHIP_ADDR_SK\" as \"cs_customer_address_id\",\n    catalog_sales.\"CS_CALL_CENTER_SK\" as \"cs_call_center_id\",\n    catalog_sales.\"CS_ITEM_SK\" as \"cs_item_id\",\n    catalog_sales.\"CS_NET_PROFIT\" as \"cs_net_profit\",\n    catalog_sales.\"CS_SHIP_DATE_SK\" as \"cs_ship_date_id\",\n    catalog_sales.\"CS_EXT_SHIP_COST\" as \"cs_extra_ship_cost\"\nFROM\n    memory.catalog_sales as catalog_sales\n),\nhelpless as (\nSELECT\n    obsolete.\"cs_order_number\" as \"cs_order_number\",\n    obsolete.\"cs_warehouse_id\" as \"cs_warehouse_id\"\nFROM\n    obsolete\n\nGROUP BY \n    obsolete.\"cs_warehouse_id\",\n    obsolete.\"cs_order_number\"),\nstarling as (\nSELECT\n    helpless.\"cs_order_number\" as \"multi_warehouse_sales\"\nFROM\n    helpless\n    FULL JOIN young on helpless.\"cs_warehouse_id\" = young.\"cs_warehouse_id\"\n\nGROUP BY \n    helpless.\"cs_order_number\"\nHAVING\n    count(young.\"cs_warehouse_id\") > 1\n),\nkestrel as (\nSELECT\n    catalog_returns.\"CR_ORDER_NUMBER\" as \"cr_sales_order_number\",\n    true as \"cr_had_return\"\nFROM\n    memory.catalog_returns as catalog_returns\nWHERE\n    true = True\n),\nsedate as (\nSELECT\n    CASE WHEN kestrel.\"cr_had_return\" = True THEN kestrel.\"cr_sales_order_number\" ELSE NULL END as \"returned_sales\"\nFROM\n    kestrel\n\nGROUP BY \n    CASE WHEN kestrel.\"cr_had_return\" = True THEN kestrel.\"cr_sales_order_number\" ELSE NULL END),\ntenuous as (\nSELECT\n    date.\"D_DATE\" as \"cs_ship_date_date\",\n    date.\"D_DATE_SK\" as \"cs_ship_date_id\"\nFROM\n    memory.date_dim as date\n),\nparakeet as (\nSELECT\n    customer_address.\"CA_ADDRESS_SK\" as \"cs_customer_address_id\",\n    customer_address.\"CA_STATE\" as \"cs_customer_state\"\nFROM\n    memory.customer_address as customer_address\n),\nsparrow as (\nSELECT\n    parakeet.\"cs_customer_address_id\" as \"cs_customer_address_id\",\n    obsolete.\"cs_call_center_id\" as \"cs_call_center_id\",\n    parakeet.\"cs_customer_state\" as \"cs_customer_state\",\n    obsolete.\"cs_item_id\" as \"cs_item_id\",\n    obsolete.\"cs_net_profit\" as \"cs_net_profit\",\n    obsolete.\"cs_order_number\" as \"cs_order_number\",\n    obsolete.\"cs_ship_date_id\" as \"cs_ship_date_id\",\n    obsolete.\"cs_extra_ship_cost\" as \"cs_extra_ship_cost\"\nFROM\n    obsolete\n    FULL JOIN parakeet on obsolete.\"cs_customer_address_id\" = parakeet.\"cs_customer_address_id\"\n),\nbarracuda as (\nSELECT\n    call_center.\"CC_COUNTY\" as \"cs_call_center_county\",\n    call_center.\"CC_CALL_CENTER_SK\" as \"cs_call_center_id\"\nFROM\n    memory.call_center as call_center\n),\nmagpie as (\nSELECT\n    barracuda.\"cs_call_center_county\" as \"cs_call_center_county\",\n    barracuda.\"cs_call_center_id\" as \"cs_call_center_id\",\n    sparrow.\"cs_customer_address_id\" as \"cs_customer_address_id\",\n    sparrow.\"cs_customer_state\" as \"cs_customer_state\",\n    sparrow.\"cs_item_id\" as \"cs_item_id\",\n    sparrow.\"cs_net_profit\" as \"cs_net_profit\",\n    sparrow.\"cs_order_number\" as \"cs_order_number\",\n    tenuous.\"cs_ship_date_date\" as \"cs_ship_date_date\",\n    sparrow.\"cs_ship_date_id\" as \"cs_ship_date_id\",\n    sparrow.\"cs_extra_ship_cost\" as \"cs_extra_ship_cost\"\nFROM\n    sparrow\n    LEFT OUTER JOIN barracuda on sparrow.\"cs_call_center_id\" = barracuda.\"cs_call_center_id\"\n    LEFT OUTER JOIN tenuous on sparrow.\"cs_ship_date_id\" = tenuous.\"cs_ship_date_id\"\n),\nhard as (\nSELECT\n    CASE WHEN magpie.\"cs_ship_date_date\" >= cast('2002-02-01' as date) and magpie.\"cs_ship_date_date\" <= cast('2002-04-02' as date) and magpie.\"cs_customer_state\" = 'GA' and magpie.\"cs_call_center_county\" = 'Williamson County' and magpie.\"cs_order_number\" not in (select sedate.\"returned_sales\" from sedate where sedate.\"returned_sales\" is not null) and magpie.\"cs_order_number\" in (select starling.\"multi_warehouse_sales\" from starling where starling.\"multi_warehouse_sales\" is not null) THEN magpie.\"cs_net_profit\" ELSE NULL END as \"cs_net_profit_9054465078561722\",\n    magpie.\"cs_net_profit\" as \"cs_net_profit\",\n    magpie.\"cs_ship_date_date\" as \"cs_ship_date_date\",\n    magpie.\"cs_customer_state\" as \"cs_customer_state\",\n    magpie.\"cs_call_center_county\" as \"cs_call_center_county\",\n    magpie.\"cs_order_number\" as \"cs_order_number\",\n    magpie.\"cs_item_id\" as \"cs_item_id\"\nFROM\n    magpie\n),\nfaithful as (\nSELECT\n    sum(hard.\"cs_net_profit_9054465078561722\") as \"total_net_profit\"\nFROM\n    hard\n),\ncrow as (\nSELECT\n    CASE WHEN magpie.\"cs_ship_date_date\" >= cast('2002-02-01' as date) and magpie.\"cs_ship_date_date\" <= cast('2002-04-02' as date) and magpie.\"cs_customer_state\" = 'GA' and magpie.\"cs_call_center_county\" = 'Williamson County' and magpie.\"cs_order_number\" not in (select sedate.\"returned_sales\" from sedate where sedate.\"returned_sales\" is not null) and magpie.\"cs_order_number\" in (select starling.\"multi_warehouse_sales\" from starling where starling.\"multi_warehouse_sales\" is not null) THEN magpie.\"cs_extra_ship_cost\" ELSE NULL END as \"cs_extra_ship_cost_19101432040703\",\n    magpie.\"cs_extra_ship_cost\" as \"cs_extra_ship_cost\",\n    magpie.\"cs_ship_date_date\" as \"cs_ship_date_date\",\n    magpie.\"cs_customer_state\" as \"cs_customer_state\",\n    magpie.\"cs_call_center_county\" as \"cs_call_center_county\",\n    magpie.\"cs_order_number\" as \"cs_order_number\",\n    magpie.\"cs_item_id\" as \"cs_item_id\"\nFROM\n    magpie\n),\njackal as (\nSELECT\n    sum(crow.\"cs_extra_ship_cost_19101432040703\") as \"total_shipping_cost\"\nFROM\n    crow\n),\nrook as (\nSELECT\n    obsolete.\"cs_customer_address_id\" as \"cs_customer_address_id\",\n    obsolete.\"cs_call_center_id\" as \"cs_call_center_id\",\n    obsolete.\"cs_order_number\" as \"cs_order_number\",\n    obsolete.\"cs_ship_date_id\" as \"cs_ship_date_id\"\nFROM\n    obsolete\n\nGROUP BY \n    obsolete.\"cs_ship_date_id\",\n    obsolete.\"cs_customer_address_id\",\n    obsolete.\"cs_call_center_id\",\n    obsolete.\"cs_order_number\"),\ncourageous as (\nSELECT\n    parakeet.\"cs_customer_address_id\" as \"cs_customer_address_id\",\n    rook.\"cs_call_center_id\" as \"cs_call_center_id\",\n    parakeet.\"cs_customer_state\" as \"cs_customer_state\",\n    rook.\"cs_order_number\" as \"cs_order_number\",\n    rook.\"cs_ship_date_id\" as \"cs_ship_date_id\"\nFROM\n    rook\n    FULL JOIN parakeet on rook.\"cs_customer_address_id\" = parakeet.\"cs_customer_address_id\"\n),\nquizzical as (\nSELECT\n    barracuda.\"cs_call_center_county\" as \"cs_call_center_county\",\n    barracuda.\"cs_call_center_id\" as \"cs_call_center_id\",\n    courageous.\"cs_customer_address_id\" as \"cs_customer_address_id\",\n    courageous.\"cs_customer_state\" as \"cs_customer_state\",\n    courageous.\"cs_order_number\" as \"cs_order_number\",\n    tenuous.\"cs_ship_date_date\" as \"cs_ship_date_date\",\n    courageous.\"cs_ship_date_id\" as \"cs_ship_date_id\"\nFROM\n    barracuda\n    LEFT OUTER JOIN courageous on barracuda.\"cs_call_center_id\" = courageous.\"cs_call_center_id\"\n    LEFT OUTER JOIN tenuous on courageous.\"cs_ship_date_id\" = tenuous.\"cs_ship_date_id\"\n),\neminent as (\nSELECT\n    CASE WHEN quizzical.\"cs_ship_date_date\" >= cast('2002-02-01' as date) and quizzical.\"cs_ship_date_date\" <= cast('2002-04-02' as date) and quizzical.\"cs_customer_state\" = 'GA' and quizzical.\"cs_call_center_county\" = 'Williamson County' and quizzical.\"cs_order_number\" not in (select sedate.\"returned_sales\" from sedate where sedate.\"returned_sales\" is not null) and quizzical.\"cs_order_number\" in (select starling.\"multi_warehouse_sales\" from starling where starling.\"multi_warehouse_sales\" is not null) THEN quizzical.\"cs_order_number\" ELSE NULL END as \"cs_order_number_6108531399904436\",\n    quizzical.\"cs_order_number\" as \"cs_order_number\",\n    quizzical.\"cs_ship_date_date\" as \"cs_ship_date_date\",\n    quizzical.\"cs_customer_state\" as \"cs_customer_state\",\n    quizzical.\"cs_call_center_county\" as \"cs_call_center_county\"\nFROM\n    quizzical\n),\nflashy as (\nSELECT\n    count(distinct eminent.\"cs_order_number_6108531399904436\") as \"order_count\"\nFROM\n    eminent\n)\n\nSELECT\n    flashy.\"order_count\" as \"order_count\",\n    jackal.\"total_shipping_cost\" as \"total_shipping_cost\",\n    faithful.\"total_net_profit\" as \"total_net_profit\"\nFROM\n    flashy\n    FULL JOIN jackal on 1=1\n    FULL JOIN faithful on 1=1\n\nORDER BY \n    flashy.\"order_count\" desc\nLIMIT (100)\n"
}